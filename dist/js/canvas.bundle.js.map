{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/Ball.js","webpack:///./src/js/CollisionInfo.js","webpack:///./src/js/Engine.js","webpack:///./src/js/Player.js","webpack:///./src/js/Rectangle.js","webpack:///./src/js/StickBox.js","webpack:///./src/js/Vec2.js","webpack:///./src/js/canvas.js","webpack:///./src/js/utils.js"],"names":["gravity","friction","Ball","x","y","dx","dy","radius","color","placeHolder","velocity","Vec2","mass","balls","rectArray","coll","i","length","prev","distance","ballToBallCollision","rect","rectCircleCollision","circleRectCollisionResponse","innerWidth","innerHeight","draw","c","beginPath","arc","Math","PI","strokeStyle","stroke","closePath","CollisionInfo","mDepth","mNormal","mStart","mEnd","s","d","n","add","scale","playerRectCollision","player","center","height","width","circle","distX","abs","distY","ball","otherBall","xVelocityDiff","yVelocityDiff","xDist","yDist","angle","atan2","m1","m2","u1","rotate","u2","v1","v2","vFinal1","vFinal2","rotatedVelocities","cos","sin","positionalCorrection","s1","s2","collisionInfo","s1InvMass","mInvMass","s2InvMass","num","getDepth","correctionAmount","getNormal","move","resolveCollision","start","end","p","r1","subtract","r2","angularVelocity","relativeVelocity","rVelocityInNormal","dot","newRestituion","min","mRestitution","newFriction","mFriction","R1crossN","cross","R2crossN","jN","mInertia","impulse","tangent","normalize","R1crossT","R2crossT","jT","Player","moving","left","right","up","jumping","vertexes","key","value","ballArray","canvas","init","console","log","fill","fillStyle","Rectangle","shouldMove","angularAcceleration","acceleration","mBoundRadius","sqrt","faceNormal","kFPS","kFrameTime","mUpdateIntervalInSeconds","updateInertia","dt","boundTest","collidedRectRect","changeDir","v","save","translate","strokeRect","restore","other","vFrom1to2","rSum","dist","otherRect","supportPoint","bestDistance","bestIndex","hasSupport","dir","ptOnEdge","findSupportPoint","tmpSupport","mSupportPoint","mSupportPointDist","bestVec","setInfo","collisionInfoR1","collisionInfoR2","status1","status2","findAxisLeastPenetration","depthVec","SupportStruct","prototype","vToEdge","projection","bounce","StickBox","points","sticks","create","updatePoints","constrainPoints","updateSticks","renderPoints","renderSticks","cratePoint","creatStick","p1","p2","push","p0","xCor","yCor","oldx","random","oldy","vx","vy","difference","percent","offsetX","offsetY","moveTo","lineTo","vec","len","r","document","querySelector","getContext","charInput","line","mouse","Line","toX","toY","colors","addEventListener","event","controll","placeH","extra","clientX","clientY","stickyBox","map","utils","randomIntFromRange","j","x1","y1","x2","y2","pow","animate","requestAnimationFrame","clearRect","forEach","update","li","max","floor","randomColor","module","exports"],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;;;;;;;;;;;;AClFA;AACA;AACA;AAEA,IAAIA,OAAO,GAAG,GAAd;AACA,IAAIC,QAAQ,GAAG,GAAf;AAEO,IAAMC,IAAb;AACC,gBAAYC,CAAZ,EAAeC,CAAf,EAAkBC,EAAlB,EAAsBC,EAAtB,EAA0BC,MAA1B,EAAkCC,KAAlC,EAAyCC,WAAzC,EAAsD;AAAA;;AACrD,SAAKN,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA,SAAKM,QAAL,GAAgB,IAAIC,0CAAJ,CAASN,EAAT,EAAaC,EAAb,CAAhB;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,KAAL,GAAaA,KAAb;AACA,SAAKI,IAAL,GAAY,CAAZ;AACA,SAAKH,WAAL,GAAmBA,WAAnB;AACA;;AATF;AAAA;AAAA,2BAYQI,KAZR,EAYeC,SAZf,EAY0B;AACxB,UAAI,CAAC,KAAKL,WAAV,EAAuB;AACtB,YAAIM,IAAI,GAAG,KAAX;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,KAAK,CAACI,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACtC,cAAI,SAASH,KAAK,CAACG,CAAD,CAAd,IAAqBH,KAAK,CAACG,CAAD,CAAL,CAASP,WAAlC,EAA+C;AAC/C,cAAMS,IAAI,GAAGL,KAAK,CAACG,CAAD,CAAlB;;AACA,cAAIG,wDAAQ,CAAC,KAAKhB,CAAL,GAAS,KAAKO,QAAL,CAAcP,CAAxB,EAA2B,KAAKC,CAAL,GAAS,KAAKM,QAAL,CAAcN,CAAlD,EAAqDc,IAAI,CAACf,CAA1D,EAA6De,IAAI,CAACd,CAAlE,CAAR,GAA+E,KAAKG,MAAL,GAAc,CAA7F,GAAkG,CAAtG,EAAyG;AACxGa,+EAAmB,CAAC,IAAD,EAAOP,KAAK,CAACG,CAAD,CAAZ,CAAnB;AACAD,gBAAI,GAAG,IAAP;AACA;AACD;;AATqB;AAAA;AAAA;;AAAA;AAWtB,+BAAgBD,SAAhB,8HAA2B;AAAA,gBAAnBO,IAAmB;;AAC1B,gBAAIC,mEAAmB,CAACD,IAAD,EAAO,IAAP,CAAvB,EAAqC;AACpCE,yFAA2B,CAACF,IAAD,EAAO,IAAP,CAA3B;AACA;AACD;AAfqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAiBtB,YAAI,KAAKlB,CAAL,GAAS,KAAKI,MAAd,IAAwB,CAAxB,IAA6B,KAAKJ,CAAL,GAAS,KAAKI,MAAd,IAAwBiB,UAAzD,EAAqE;AACpE,eAAKd,QAAL,CAAcP,CAAd,GAAkB,CAAE,KAAKO,QAAL,CAAcP,CAAlC;AACA;;AACD,YAAK,KAAKC,CAAL,GAAS,KAAKG,MAAf,GAAyB,KAAKG,QAAL,CAAcN,CAAvC,IAA4C,CAA5C,IAAkD,KAAKA,CAAL,GAAS,KAAKG,MAAf,GAAyB,KAAKG,QAAL,CAAcN,CAAvC,IAA4CqB,WAAjG,EAA8G;AAC7G,eAAKf,QAAL,CAAcN,CAAd,GAAkB,CAAE,KAAKM,QAAL,CAAcN,CAAlC;AACA,eAAKM,QAAL,CAAcN,CAAd,GAAkB,KAAKM,QAAL,CAAcN,CAAd,GAAkBH,QAApC;AACA,eAAKS,QAAL,CAAcP,CAAd,GAAkB,KAAKO,QAAL,CAAcP,CAAd,GAAkBF,QAApC;AACA,SAJD,MAKK;AACJ,cAAI,CAACc,IAAL,EAAW;AACV,iBAAKL,QAAL,CAAcN,CAAd,IAAmBJ,OAAnB;AACA,WAFD,MAEO,CACN;AACD;;AACD,aAAKG,CAAL,IAAU,KAAKO,QAAL,CAAcP,CAAxB;AACA,aAAKC,CAAL,IAAU,KAAKM,QAAL,CAAcN,CAAxB;AACA;;AAED,WAAKsB,IAAL;AACA;AAjDF;AAAA;AAAA,2BAmDQ;AACNC,+CAAC,CAACC,SAAF;AACAD,+CAAC,CAACE,GAAF,CAAM,KAAK1B,CAAX,EAAc,KAAKC,CAAnB,EAAsB,KAAKG,MAA3B,EAAmC,CAAnC,EAAsCuB,IAAI,CAACC,EAAL,GAAU,CAAhD,EAAmD,KAAnD;AACAJ,+CAAC,CAACK,WAAF,GAAgB,KAAKxB,KAArB;AACAmB,+CAAC,CAACM,MAAF;AACAN,+CAAC,CAACO,SAAF;AACA;AAzDF;;AAAA;AAAA,I;;;;;;;;;;;;;;;;;;;;;ACPA;AAEO,IAAMC,aAAb;AACC,2BAAc;AAAA;;AACb,SAAKC,MAAL,GAAc,CAAd;AACA,SAAKC,OAAL,GAAe,IAAI1B,0CAAJ,CAAS,CAAT,EAAY,CAAZ,CAAf;AACA,SAAK2B,MAAL,GAAc,IAAI3B,0CAAJ,CAAS,CAAT,EAAY,CAAZ,CAAd;AACA,SAAK4B,IAAL,GAAY,IAAI5B,0CAAJ,CAAS,CAAT,EAAY,CAAZ,CAAZ;AACA;;AANF;AAAA;AAAA,6BAQU6B,CARV,EAQa;AACX,WAAKJ,MAAL,GAAcI,CAAd;AACA;AAVF;AAAA;AAAA,8BAYWA,CAZX,EAYc;AACZ,WAAKH,OAAL,GAAeG,CAAf;AACA;AAdF;AAAA;AAAA,+BAgBY;AACV,aAAO,KAAKJ,MAAZ;AACA;AAlBF;AAAA;AAAA,gCAoBa;AACX,aAAO,KAAKC,OAAZ;AACA;AAtBF;AAAA;AAAA,4BAwBSI,CAxBT,EAwBYC,CAxBZ,EAwBeF,CAxBf,EAwBkB;AAChB,WAAKJ,MAAL,GAAcK,CAAd;AACA,WAAKJ,OAAL,GAAeK,CAAf;AACA,WAAKJ,MAAL,GAAcE,CAAd;AACA,WAAKD,IAAL,GAAYC,CAAC,CAACG,GAAF,CAAMD,CAAC,CAACE,KAAF,CAAQH,CAAR,CAAN,CAAZ;AACA;AA7BF;AAAA;AAAA,gCA+Ba;AACX,WAAKJ,OAAL,GAAe,KAAKA,OAAL,CAAaO,KAAb,CAAmB,CAAC,CAApB,CAAf;AACA,UAAIF,CAAC,GAAG,KAAKJ,MAAb;AACA,WAAKA,MAAL,GAAc,KAAKC,IAAnB;AACA,WAAKA,IAAL,GAAYG,CAAZ;AACA;AApCF;;AAAA;AAAA,I;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGO,IAAMG,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,MAAD,EAASzB,IAAT,EAAkB;AACpD,MAAIyB,MAAM,CAACpC,QAAP,CAAgBN,CAAhB,IAAqB,CAArB,IACD0C,MAAM,CAACC,MAAP,CAAc3C,CAAd,GAAkB0C,MAAM,CAACE,MAAzB,GAAkCF,MAAM,CAACpC,QAAP,CAAgBN,CAAlD,IAAuDiB,IAAI,CAAC0B,MAAL,CAAY3C,CAAZ,GAAgBiB,IAAI,CAAC2B,MAAL,GAAc,CADpF,IAEAF,MAAM,CAACC,MAAP,CAAc3C,CAAd,GAAkB0C,MAAM,CAACE,MAAzB,IAAmC3B,IAAI,CAAC0B,MAAL,CAAY3C,CAF/C,IAGA0C,MAAM,CAACC,MAAP,CAAc5C,CAAd,IAAmBkB,IAAI,CAAC0B,MAAL,CAAY5C,CAAZ,GAAgBkB,IAAI,CAAC4B,KAArB,GAA6BH,MAAM,CAACG,KAHvD,IAIAH,MAAM,CAACC,MAAP,CAAc5C,CAAd,GAAkB2C,MAAM,CAACG,KAAzB,IAAkC5B,IAAI,CAAC0B,MAAL,CAAY5C,CAJlD,EAIqD;AACnD2C,UAAM,CAACC,MAAP,CAAc3C,CAAd,GAAkBiB,IAAI,CAAC0B,MAAL,CAAY3C,CAAZ,GAAgB0C,MAAM,CAACE,MAAvB,GAAgC3B,IAAI,CAAC2B,MAAL,GAAc,CAAhE;AACAF,UAAM,CAACpC,QAAP,CAAgBN,CAAhB,GAAoB,CAApB;AACD;AACD,CATM;AAWA,IAAMkB,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACwB,MAAD,EAASI,MAAT,EAAoB;AACtD,MAAMC,KAAK,GAAGrB,IAAI,CAACsB,GAAL,CAASF,MAAM,CAAC/C,CAAP,GAAW2C,MAAM,CAACC,MAAP,CAAc5C,CAAzB,GAA6B2C,MAAM,CAACG,KAAP,GAAe,CAArD,CAAd;AACA,MAAMI,KAAK,GAAGvB,IAAI,CAACsB,GAAL,CAASF,MAAM,CAAC9C,CAAP,GAAW0C,MAAM,CAACC,MAAP,CAAc3C,CAAzB,GAA6B0C,MAAM,CAACE,MAAP,GAAgB,CAAtD,CAAd;;AAEA,MAAIG,KAAK,GAAIL,MAAM,CAACG,KAAP,GAAe,CAAf,GAAmBC,MAAM,CAAC3C,MAAvC,EAAgD;AAC/C,WAAO,KAAP;AACA;;AAED,MAAI8C,KAAK,GAAIP,MAAM,CAACE,MAAP,GAAgB,CAAhB,GAAoBE,MAAM,CAAC3C,MAAxC,EAAiD;AAChD,WAAO,KAAP;AACA;;AAED,MAAI4C,KAAK,IAAKL,MAAM,CAACG,KAAP,GAAe,CAA7B,EAAiC;AAChC,WAAO,IAAP;AACA;;AAED,MAAII,KAAK,IAAKP,MAAM,CAACE,MAAP,GAAgB,CAA9B,EAAkC;AACjC,WAAO,IAAP;AACA;;AAED,MAAM3C,EAAE,GAAG8C,KAAK,GAAGL,MAAM,CAACG,KAAP,GAAe,CAAlC;AACA,MAAM3C,EAAE,GAAG+C,KAAK,GAAGP,MAAM,CAACE,MAAP,GAAgB,CAAnC;AACA,SAAQ3C,EAAE,GAACA,EAAH,GAAMC,EAAE,GAACA,EAAT,IAAgB4C,MAAM,CAAC3C,MAAP,GAAc2C,MAAM,CAAC3C,MAA7C;AACA,CAvBM;AAyBA,IAAMgB,2BAA2B,GAAG,SAA9BA,2BAA8B,CAACF,IAAD,EAAO6B,MAAP,EAAkB,CAE5D,CAFM;AAIA,IAAM9B,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACkC,IAAD,EAAOC,SAAP,EAAqB;AACpD,MAAMC,aAAa,GAAGF,IAAI,CAAC5C,QAAL,CAAcP,CAAd,GAAkBoD,SAAS,CAAC7C,QAAV,CAAmBP,CAA3D;AACA,MAAMsD,aAAa,GAAGH,IAAI,CAAC5C,QAAL,CAAcN,CAAd,GAAkBmD,SAAS,CAAC7C,QAAV,CAAmBN,CAA3D;AAEA,MAAMsD,KAAK,GAAGH,SAAS,CAACpD,CAAV,GAAcmD,IAAI,CAACnD,CAAjC;AACA,MAAMwD,KAAK,GAAGJ,SAAS,CAACnD,CAAV,GAAckD,IAAI,CAAClD,CAAjC,CALoD,CAOpD;;AACA,MAAIoD,aAAa,GAAGE,KAAhB,GAAwBD,aAAa,GAAGE,KAAxC,IAAiD,CAArD,EAAwD;AAEpD;AACA,QAAMC,KAAK,GAAG,CAAC9B,IAAI,CAAC+B,KAAL,CAAWN,SAAS,CAACnD,CAAV,GAAckD,IAAI,CAAClD,CAA9B,EAAiCmD,SAAS,CAACpD,CAAV,GAAcmD,IAAI,CAACnD,CAApD,CAAf,CAHoD,CAKpD;;AACA,QAAM2D,EAAE,GAAGR,IAAI,CAAC1C,IAAhB;AACA,QAAMmD,EAAE,GAAGR,SAAS,CAAC3C,IAArB,CAPoD,CASpD;;AACA,QAAMoD,EAAE,GAAGC,MAAM,CAACX,IAAI,CAAC5C,QAAN,EAAgBkD,KAAhB,CAAjB;AACA,QAAMM,EAAE,GAAGD,MAAM,CAACV,SAAS,CAAC7C,QAAX,EAAqBkD,KAArB,CAAjB,CAXoD,CAapD;;AACA,QAAMO,EAAE,GAAG;AAAEhE,OAAC,EAAE6D,EAAE,CAAC7D,CAAH,IAAQ2D,EAAE,GAAGC,EAAb,KAAoBD,EAAE,GAAGC,EAAzB,IAA+BG,EAAE,CAAC/D,CAAH,GAAO,CAAP,GAAW4D,EAAX,IAAiBD,EAAE,GAAGC,EAAtB,CAApC;AAA+D3D,OAAC,EAAE4D,EAAE,CAAC5D;AAArE,KAAX;AACA,QAAMgE,EAAE,GAAG;AAAEjE,OAAC,EAAE+D,EAAE,CAAC/D,CAAH,IAAQ2D,EAAE,GAAGC,EAAb,KAAoBD,EAAE,GAAGC,EAAzB,IAA+BC,EAAE,CAAC7D,CAAH,GAAO,CAAP,GAAW4D,EAAX,IAAiBD,EAAE,GAAGC,EAAtB,CAApC;AAA+D3D,OAAC,EAAE8D,EAAE,CAAC9D;AAArE,KAAX,CAfoD,CAiBpD;;AACA,QAAMiE,OAAO,GAAGJ,MAAM,CAACE,EAAD,EAAK,CAACP,KAAN,CAAtB;AACA,QAAMU,OAAO,GAAGL,MAAM,CAACG,EAAD,EAAK,CAACR,KAAN,CAAtB,CAnBoD,CAqBpD;;AACAN,QAAI,CAAC5C,QAAL,CAAcP,CAAd,GAAkBkE,OAAO,CAAClE,CAA1B;AACAmD,QAAI,CAAC5C,QAAL,CAAcN,CAAd,GAAkBiE,OAAO,CAACjE,CAA1B;AAEAmD,aAAS,CAAC7C,QAAV,CAAmBP,CAAnB,GAAuBmE,OAAO,CAACnE,CAA/B;AACAoD,aAAS,CAAC7C,QAAV,CAAmBN,CAAnB,GAAuBkE,OAAO,CAAClE,CAA/B;AACH;AACJ,CApCM;;AAsCP,IAAM6D,MAAM,GAAG,SAATA,MAAS,CAACvD,QAAD,EAAWkD,KAAX,EAAqB;AAChC,MAAMW,iBAAiB,GAAG;AACtBpE,KAAC,EAAEO,QAAQ,CAACP,CAAT,GAAa2B,IAAI,CAAC0C,GAAL,CAASZ,KAAT,CAAb,GAA+BlD,QAAQ,CAACN,CAAT,GAAa0B,IAAI,CAAC2C,GAAL,CAASb,KAAT,CADzB;AAEtBxD,KAAC,EAAEM,QAAQ,CAACP,CAAT,GAAa2B,IAAI,CAAC2C,GAAL,CAASb,KAAT,CAAb,GAA+BlD,QAAQ,CAACN,CAAT,GAAa0B,IAAI,CAAC0C,GAAL,CAASZ,KAAT;AAFzB,GAA1B;AAKA,SAAOW,iBAAP;AACH,CAPD;;AASA,IAAIG,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAUC,EAAV,EAAcC,EAAd,EAAkBC,aAAlB,EAAiC;AAC3D,MAAIC,SAAS,GAAGH,EAAE,CAACI,QAAnB;AACA,MAAIC,SAAS,GAAGJ,EAAE,CAACG,QAAnB;AAEA,MAAIE,GAAG,GAAGJ,aAAa,CAACK,QAAd,MAA4BJ,SAAS,GAAGE,SAAxC,IAAqD,GAA/D;AACA,MAAIG,gBAAgB,GAAGN,aAAa,CAACO,SAAd,GAA0BxC,KAA1B,CAAgCqC,GAAhC,CAAvB;AAEAN,IAAE,CAACU,IAAH,CAAQF,gBAAgB,CAACvC,KAAjB,CAAuB,CAACkC,SAAxB,CAAR;AACAF,IAAE,CAACS,IAAH,CAAQF,gBAAgB,CAACvC,KAAjB,CAAuBoC,SAAvB,CAAR;AACA,CATD;;AAWO,IAAMM,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUX,EAAV,EAAcC,EAAd,EAAkBC,aAAlB,EAAiC;AAChE,MAAKF,EAAE,CAACI,QAAH,KAAgB,CAAjB,IAAwBH,EAAE,CAACG,QAAH,KAAgB,CAA5C,EAAgD;AAC/C;AACA;;AAEDL,sBAAoB,CAACC,EAAD,EAAKC,EAAL,EAASC,aAAT,CAApB;AAEA,MAAInC,CAAC,GAAGmC,aAAa,CAACO,SAAd,EAAR,CAPgE,CAShE;AACA;;AACA,MAAIG,KAAK,GAAGV,aAAa,CAACvC,MAAd,CAAqBM,KAArB,CAA2BgC,EAAE,CAACG,QAAH,IAAeJ,EAAE,CAACI,QAAH,GAAcH,EAAE,CAACG,QAAhC,CAA3B,CAAZ;AACA,MAAIS,GAAG,GAAGX,aAAa,CAACtC,IAAd,CAAmBK,KAAnB,CAAyB+B,EAAE,CAACI,QAAH,IAAeJ,EAAE,CAACI,QAAH,GAAcH,EAAE,CAACG,QAAhC,CAAzB,CAAV;AACA,MAAIU,CAAC,GAAGF,KAAK,CAAC5C,GAAN,CAAU6C,GAAV,CAAR,CAbgE,CAchE;;AACA,MAAIE,EAAE,GAAGD,CAAC,CAACE,QAAF,CAAWhB,EAAE,CAAC5B,MAAd,CAAT;AACA,MAAI6C,EAAE,GAAGH,CAAC,CAACE,QAAF,CAAWf,EAAE,CAAC7B,MAAd,CAAT,CAhBgE,CAkBhE;;AACA,MAAIoB,EAAE,GAAGQ,EAAE,CAACjE,QAAH,CAAYiC,GAAZ,CAAgB,IAAIhC,0CAAJ,CAAS,CAAC,CAAD,GAAKgE,EAAE,CAACkB,eAAR,GAA0BH,EAAE,CAACtF,CAAtC,EAAyCuE,EAAE,CAACkB,eAAH,GAAqBH,EAAE,CAACvF,CAAjE,CAAhB,CAAT;AACA,MAAIiE,EAAE,GAAGQ,EAAE,CAAClE,QAAH,CAAYiC,GAAZ,CAAgB,IAAIhC,0CAAJ,CAAS,CAAC,CAAD,GAAKiE,EAAE,CAACiB,eAAR,GAA0BD,EAAE,CAACxF,CAAtC,EAAyCwE,EAAE,CAACiB,eAAH,GAAqBD,EAAE,CAACzF,CAAjE,CAAhB,CAAT;AAEA,MAAI2F,gBAAgB,GAAG1B,EAAE,CAACuB,QAAH,CAAYxB,EAAZ,CAAvB,CAtBgE,CAwBhE;;AACA,MAAI4B,iBAAiB,GAAGD,gBAAgB,CAACE,GAAjB,CAAqBtD,CAArB,CAAxB,CAzBgE,CA2BhE;;AACA,MAAIqD,iBAAiB,GAAG,CAAxB,EAA2B;AAC1B;AACA,GA9B+D,CAgChE;;;AACA,MAAIE,aAAa,GAAGnE,IAAI,CAACoE,GAAL,CAASvB,EAAE,CAACwB,YAAZ,EAA0BvB,EAAE,CAACuB,YAA7B,CAApB;AACA,MAAIC,WAAW,GAAGtE,IAAI,CAACoE,GAAL,CAASvB,EAAE,CAAC0B,SAAZ,EAAuBzB,EAAE,CAACyB,SAA1B,CAAlB,CAlCgE,CAoChE;;AACA,MAAIC,QAAQ,GAAGZ,EAAE,CAACa,KAAH,CAAS7D,CAAT,CAAf;AACA,MAAI8D,QAAQ,GAAGZ,EAAE,CAACW,KAAH,CAAS7D,CAAT,CAAf,CAtCgE,CAyChE;AACA;;AACA,MAAI+D,EAAE,GAAG,EAAE,IAAIR,aAAN,IAAuBF,iBAAhC;AACAU,IAAE,GAAGA,EAAE,IAAI9B,EAAE,CAACI,QAAH,GAAcH,EAAE,CAACG,QAAjB,GACTuB,QAAQ,GAAGA,QAAX,GAAsB3B,EAAE,CAAC+B,QADhB,GAETF,QAAQ,GAAGA,QAAX,GAAsB5B,EAAE,CAAC8B,QAFpB,CAAP,CA5CgE,CAgDhE;;AACA,MAAIC,OAAO,GAAGjE,CAAC,CAACE,KAAF,CAAQ6D,EAAR,CAAd,CAjDgE,CAmDhE;AACA;;AACA9B,IAAE,CAACjE,QAAH,GAAciE,EAAE,CAACjE,QAAH,CAAYiF,QAAZ,CAAqBgB,OAAO,CAAC/D,KAAR,CAAc,CAAd,CAArB,CAAd;AACAgC,IAAE,CAAClE,QAAH,GAAckE,EAAE,CAAClE,QAAH,CAAYiC,GAAZ,CAAgBgE,OAAO,CAAC/D,KAAR,CAAc,CAAd,CAAhB,CAAd;AAEA+B,IAAE,CAACkB,eAAH,IAAsBS,QAAQ,GAAGG,EAAX,GAAgB9B,EAAE,CAAC+B,QAAzC;AACA9B,IAAE,CAACiB,eAAH,IAAsBW,QAAQ,GAAGC,EAAX,GAAgB7B,EAAE,CAAC8B,QAAzC;AAEA,MAAIE,OAAO,GAAGd,gBAAgB,CAACH,QAAjB,CAA0BjD,CAAC,CAACE,KAAF,CAAQkD,gBAAgB,CAACE,GAAjB,CAAqBtD,CAArB,CAAR,CAA1B,CAAd,CA3DgE,CA6DhE;;AACAkE,SAAO,GAAGA,OAAO,CAACC,SAAR,GAAoBjE,KAApB,CAA0B,CAAC,CAA3B,CAAV;AAGA,MAAIkE,QAAQ,GAAGpB,EAAE,CAACa,KAAH,CAASK,OAAT,CAAf;AACA,MAAIG,QAAQ,GAAGnB,EAAE,CAACW,KAAH,CAASK,OAAT,CAAf;AAGA,MAAII,EAAE,GAAG,EAAE,IAAIf,aAAN,IAAuBH,gBAAgB,CAACE,GAAjB,CAAqBY,OAArB,CAAvB,GAAuDR,WAAhE;AACAY,IAAE,GAAGA,EAAE,IAAIrC,EAAE,CAACI,QAAH,GAAcH,EAAE,CAACG,QAAjB,GAA4B+B,QAAQ,GAAGA,QAAX,GAAsBnC,EAAE,CAAC+B,QAArD,GAAgEK,QAAQ,GAAGA,QAAX,GAAsBnC,EAAE,CAAC8B,QAA7F,CAAP,CAtEgE,CAwEhE;;AACA,MAAIM,EAAE,GAAGP,EAAT,EAAa;AACZO,MAAE,GAAGP,EAAL;AACA,GA3E+D,CA6EhE;;;AACAE,SAAO,GAAGC,OAAO,CAAChE,KAAR,CAAcoE,EAAd,CAAV;AAEArC,IAAE,CAACjE,QAAH,GAAciE,EAAE,CAACjE,QAAH,CAAYiF,QAAZ,CAAqBgB,OAAO,CAAC/D,KAAR,CAAc+B,EAAE,CAACI,QAAjB,CAArB,CAAd;AACAH,IAAE,CAAClE,QAAH,GAAckE,EAAE,CAAClE,QAAH,CAAYiC,GAAZ,CAAgBgE,OAAO,CAAC/D,KAAR,CAAcgC,EAAE,CAACG,QAAjB,CAAhB,CAAd;AACAJ,IAAE,CAACkB,eAAH,IAAsBiB,QAAQ,GAAGE,EAAX,GAAgBrC,EAAE,CAAC+B,QAAzC;AACA9B,IAAE,CAACiB,eAAH,IAAsBkB,QAAQ,GAAGC,EAAX,GAAgBpC,EAAE,CAAC8B,QAAzC;AACA,CApFM,C;;;;;;;;;;;;;;;;;;;;;;;ACrGP;AACA;AACA;AAEA,IAAI1G,OAAO,GAAG,GAAd;AACA,IAAIC,QAAQ,GAAG,GAAf;AAEO,IAAMgH,MAAb;AACC,kBAAYlE,MAAZ,EAAoBE,KAApB,EAA2BD,MAA3B,EAAmCtC,QAAnC,EAA6CF,KAA7C,EAAoDoD,KAApD,EAA2D;AAAA;;AAC1D,SAAKsD,MAAL,GAAc;AACbC,UAAI,EAAE,KADO;AAEbC,WAAK,EAAE,KAFM;AAGbC,QAAE,EAAE;AAHS,KAAd;AAKA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKvE,MAAL,GAAcA,MAAd;AACA,SAAKE,KAAL,GAAaA,KAAb;AACA,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKY,KAAL,GAAaA,KAAb;AACA,SAAKlD,QAAL,GAAgBA,QAAhB;AACA,SAAKE,IAAL,GAAY,CAAZ;AACA,SAAKJ,KAAL,GAAaA,KAAb;AACA,SAAK+G,QAAL,GAAgB,CACf,IAAI5G,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW6C,MAAM,GAAG,CAA7B,EAAgCD,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAApD,CADe,EAEf,IAAIrC,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW6C,MAAM,GAAG,CAA7B,EAAgCD,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAApD,CAFe,EAGf,IAAIrC,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW6C,MAAM,GAAG,CAA7B,EAAgCD,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAApD,CAHe,EAIf,IAAIrC,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW6C,MAAM,GAAG,CAA7B,EAAgCD,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAApD,CAJe,CAAhB;AAMA;;AArBF;AAAA;AAAA,6BAuBUwE,GAvBV,EAuBeC,KAvBf,EAuBsB;AACpB,UAAID,GAAG,KAAK,GAAZ,EAAiB;AAChB,aAAKN,MAAL,CAAYC,IAAZ,GAAmBM,KAAnB;AACA,OAFD,MAEO,IAAID,GAAG,KAAK,GAAZ,EAAiB;AACvB,aAAKN,MAAL,CAAYE,KAAZ,GAAoBK,KAApB;AACA,OAFM,MAEA,IAAID,GAAG,KAAK,GAAR,IAAeA,GAAG,KAAK,GAA3B,EAAgC;AACtC,aAAKN,MAAL,CAAYG,EAAZ,GAAiBI,KAAjB;AACA;AAED;AAhCF;AAAA;AAAA,2BAkCQ3G,SAlCR,EAkCmB4G,SAlCnB,EAkC8B;AAC5B,WAAKhH,QAAL,CAAcN,CAAd,IAAmBJ,OAAnB;AACA,WAAKU,QAAL,CAAcP,CAAd,IAAmB,GAAnB,CAF4B,CAI5B;;AACA,UAAI,KAAK4C,MAAL,CAAY3C,CAAZ,IAAiBuH,8CAAM,CAAC3E,MAA5B,EAAoC;AACnC4E,4DAAI;AACJ;;AAED,UAAI9G,SAAJ,EAAe;AAAA;AAAA;AAAA;;AAAA;AACd,+BAAiBA,SAAjB,8HAA4B;AAAA,gBAAnBO,IAAmB;;AAC3B,gBAAI,KAAKX,QAAL,CAAcN,CAAd,IAAmB,CAAvB,EAA0B;AACzByC,iFAAmB,CAAC,IAAD,EAAOxB,IAAP,CAAnB;AACA;AACD;AALa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMd;;AACD,UAAIqG,SAAJ,EAAe;AAAA;AAAA;AAAA;;AAAA;AACd,gCAAmBA,SAAnB,mIAA8B;AAAA,gBAArBxE,MAAqB;;AAC7B,gBAAI5B,mEAAmB,CAAC,IAAD,EAAO4B,MAAP,CAAvB,EAAuC;AACtC0E,kEAAI;AACJC,qBAAO,CAACC,GAAR,CAAY,WAAZ;AACA;AACD;AANa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOd;;AACD,UAAI,KAAK/E,MAAL,CAAY5C,CAAZ,GAAiB,KAAK8C,KAAL,GAAa,CAA9B,GAAmC,KAAKvC,QAAL,CAAcP,CAAjD,IAAsD,CAAtD,IAA2D,KAAK4C,MAAL,CAAY5C,CAAZ,GAAiB,KAAK8C,KAAL,GAAa,CAA9B,GAAmC,KAAKvC,QAAL,CAAcP,CAAjD,IAAsDqB,UAArH,EAAiI;AAChI,aAAKd,QAAL,CAAcP,CAAd,GAAkB,CAAE,KAAKO,QAAL,CAAcP,CAAlC;AACA,aAAKO,QAAL,CAAcP,CAAd,GAAkB,KAAKO,QAAL,CAAcP,CAAd,GAAkBF,QAApC;AACA;;AACD,UAAI,KAAKiH,MAAL,CAAYC,IAAhB,EAAsB;AACrB,aAAKzG,QAAL,CAAcP,CAAd,IAAmB,CAAnB;AACA,OAFD,MAEO,IAAI,KAAK+G,MAAL,CAAYE,KAAhB,EAAuB;AAC7B,aAAK1G,QAAL,CAAcP,CAAd,IAAmB,CAAnB;AACA,OAFM,MAEA,IAAI,KAAK+G,MAAL,CAAYG,EAAhB,EAAoB;AAC1B,aAAK3G,QAAL,CAAcN,CAAd,GAAkB,CAAC,EAAnB;AACA;;AAED,WAAK2C,MAAL,CAAY5C,CAAZ,IAAiB,KAAKO,QAAL,CAAcP,CAA/B;AACA,WAAK4C,MAAL,CAAY3C,CAAZ,IAAiB,KAAKM,QAAL,CAAcN,CAA/B;AACA,WAAKsB,IAAL;AACA;AAzEF;AAAA;AAAA,2BA2EQ;AACNC,+CAAC,CAACC,SAAF;AACAD,+CAAC,CAACN,IAAF,CAAO,KAAK0B,MAAL,CAAY5C,CAAnB,EAAsB,KAAK4C,MAAL,CAAY3C,CAAlC,EAAqC,KAAK6C,KAA1C,EAAiD,KAAKD,MAAtD;AACArB,+CAAC,CAACoG,IAAF;AACApG,+CAAC,CAACqG,SAAF,GAAc,KAAd;AACArG,+CAAC,CAACK,WAAF,GAAgB,KAAhB;AACAL,+CAAC,CAACM,MAAF;AACAN,+CAAC,CAACO,SAAF;AACA;AAnFF;;AAAA;AAAA,I;;;;;;;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AAEA,IAAIlC,OAAO,GAAG,GAAd;AACA,IAAIC,QAAQ,GAAG,GAAf;AAEO,IAAMgI,SAAb;AACC,qBAAYlF,MAAZ,EAAoBE,KAApB,EAA2BD,MAA3B,EAAmCtC,QAAnC,EAA6CF,KAA7C,EAAoDoD,KAApD,EAA2DsE,UAA3D,EAAuE;AAAA;;AACtE,SAAKnF,MAAL,GAAcA,MAAd;AACA,SAAKE,KAAL,GAAaA,KAAb;AACA,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKY,KAAL,GAAa,CAAb;AACA,SAAKlD,QAAL,GAAgBA,QAAhB;AACA,SAAKE,IAAL,GAAY,CAAZ;AACA,SAAKsH,UAAL,GAAkBA,UAAlB;AACA,SAAK7B,SAAL,GAAiBpG,QAAjB;AACA,SAAK8E,QAAL,GAAgB,CAAhB;AACA,SAAKc,eAAL,GAAuB,CAAvB;AACA,SAAKsC,mBAAL,GAA2B,CAA3B;AACA,SAAKhC,YAAL,GAAoB,GAApB;AACA,SAAK3F,KAAL,GAAaA,KAAb;AACA,SAAK4H,YAAL,GAAoB,IAAIzH,0CAAJ,CAAS,CAAT,EAAY,EAAZ,CAApB;AACA,SAAK+F,QAAL,GAAgB,CAAhB;AACA,SAAK2B,YAAL,GAAoBvG,IAAI,CAACwG,IAAL,CAAUrF,KAAK,GAAGA,KAAR,GAAgBD,MAAM,GAAGA,MAAnC,IAA6C,CAAjE;AACA,SAAKuE,QAAL,GAAgB,CACf,IAAI5G,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW8C,KAAK,GAAG,CAA5B,EAA+BF,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAAnD,CADe,EAEf,IAAIrC,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW8C,KAAK,GAAG,CAA5B,EAA+BF,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAAnD,CAFe,EAGf,IAAIrC,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW8C,KAAK,GAAG,CAA5B,EAA+BF,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAAnD,CAHe,EAIf,IAAIrC,0CAAJ,CAASoC,MAAM,CAAC5C,CAAP,GAAW8C,KAAK,GAAG,CAA5B,EAA+BF,MAAM,CAAC3C,CAAP,GAAW4C,MAAM,GAAG,CAAnD,CAJe,CAAhB;AAMA,SAAKuF,UAAL,GAAkB,EAAlB;AACA,SAAKA,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,SAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,SAAK0B,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,SAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,SAAK0B,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,SAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,SAAK0B,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,SAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,SAAK2B,IAAL,GAAY,EAAZ,CAhCsE,CAgC7C;;AACzB,SAAKC,UAAL,GAAkB,IAAI,KAAKD,IAA3B;AACA,SAAKE,wBAAL,GAAgC,KAAKD,UAArC;AACA,SAAKxE,MAAL,CAAYL,KAAZ;AACA,SAAK+E,aAAL;AACA;;AAtCF;AAAA;AAAA,2BAwCQ7H,SAxCR,EAwCmB4G,SAxCnB,EAwC8B;AAE5B,UAAMkB,EAAE,GAAG,KAAKF,wBAAhB;AACA,WAAKhI,QAAL,GAAgB,KAAKA,QAAL,CAAciC,GAAd,CAAkB,KAAKyF,YAAL,CAAkBxF,KAAlB,CAAwBgG,EAAxB,CAAlB,CAAhB;AACA,WAAKvD,IAAL,CAAU,KAAK3E,QAAL,CAAckC,KAAd,CAAoBgG,EAApB,CAAV;AACA,WAAK/C,eAAL,IAAwB,KAAKsC,mBAAL,GAA2BS,EAAnD;AACA,WAAK3E,MAAL,CAAY,KAAK4B,eAAL,GAAuB+C,EAAnC;;AAEA,WAAK,IAAI5H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,SAAS,CAACG,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AAC1C,YAAI,SAASF,SAAS,CAACE,CAAD,CAAtB,EAA2B;;AAC3B,YAAI,KAAK6H,SAAL,CAAe/H,SAAS,CAACE,CAAD,CAAxB,CAAJ,EAAkC;AAChC,cAAI6D,aAAa,GAAG,IAAI1C,4DAAJ,EAApB;;AACA,cAAI,KAAK2G,gBAAL,CAAsB,IAAtB,EAA4BhI,SAAS,CAACE,CAAD,CAArC,EAA0C6D,aAA1C,CAAJ,EAA8D;AAC7D,gBAAIA,aAAa,CAACO,SAAd,GAA0BY,GAA1B,CAA8BlF,SAAS,CAACE,CAAD,CAAT,CAAa+B,MAAb,CAAoB4C,QAApB,CAA6B,KAAK5C,MAAlC,CAA9B,IAA2E,CAA/E,EAAkF;AACjF8B,2BAAa,CAACkE,SAAd;AACA;;AACDzD,4EAAgB,CAAC,IAAD,EAAOxE,SAAS,CAACE,CAAD,CAAhB,EAAqB6D,aAArB,CAAhB;AAEA;AACD;AACF;;AAED,WAAKnD,IAAL;AACA;AA/DF;AAAA;AAAA,yBAiEMsH,CAjEN,EAiES;AACP,WAAK,IAAIhI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKuG,QAAL,CAActG,MAAlC,EAA0CD,CAAC,EAA3C,EAA+C;AAC9C,aAAKuG,QAAL,CAAcvG,CAAd,IAAmB,KAAKuG,QAAL,CAAcvG,CAAd,EAAiB2B,GAAjB,CAAqBqG,CAArB,CAAnB;AACA;;AACD,WAAKjG,MAAL,GAAc,KAAKA,MAAL,CAAYJ,GAAZ,CAAgBqG,CAAhB,CAAd;AACA;AAtEF;AAAA;AAAA,2BAwEQ;AACNrH,+CAAC,CAACsH,IAAF;AACAtH,+CAAC,CAACuH,SAAF,CAAY,KAAK3B,QAAL,CAAc,CAAd,EAAiBpH,CAA7B,EAAgC,KAAKoH,QAAL,CAAc,CAAd,EAAiBnH,CAAjD;AACAuB,+CAAC,CAACsC,MAAF,CAAS,KAAKL,KAAd;AACAjC,+CAAC,CAACK,WAAF,GAAgB,KAAKxB,KAArB;AACAmB,+CAAC,CAACwH,UAAF,CAAa,CAAb,EAAgB,CAAhB,EAAmB,KAAKlG,KAAxB,EAA+B,KAAKD,MAApC;AACArB,+CAAC,CAACyH,OAAF;AACAzH,+CAAC,CAACC,SAAF;AACAD,+CAAC,CAACE,GAAF,CAAM,KAAKkB,MAAL,CAAY5C,CAAlB,EAAqB,KAAK4C,MAAL,CAAY3C,CAAjC,EAAoC,CAApC,EAAuC,CAAvC,EAA0C0B,IAAI,CAACC,EAAL,GAAU,CAApD,EAAuD,KAAvD;AACAJ,+CAAC,CAACM,MAAF;AACAN,+CAAC,CAACO,SAAF;AACA;AAnFF;AAAA;AAAA,2BAsFQ0B,KAtFR,EAsFe;AACb,WAAKA,KAAL,IAAcA,KAAd;;AAEA,WAAK,IAAI5C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKuG,QAAL,CAActG,MAAlC,EAA0CD,CAAC,EAA3C,EAA+C;AAC9C,aAAKuG,QAAL,CAAcvG,CAAd,IAAmB,KAAKuG,QAAL,CAAcvG,CAAd,EAAiBiD,MAAjB,CAAwB,KAAKlB,MAA7B,EAAqCa,KAArC,CAAnB;AACA;;AACD,WAAK2E,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,WAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,WAAK0B,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,WAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,WAAK0B,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,WAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,WAAK0B,UAAL,CAAgB,CAAhB,IAAqB,KAAKhB,QAAL,CAAc,CAAd,EAAiB5B,QAAjB,CAA0B,KAAK4B,QAAL,CAAc,CAAd,CAA1B,CAArB;AACA,WAAKgB,UAAL,CAAgB,CAAhB,IAAqB,KAAKA,UAAL,CAAgB,CAAhB,EAAmB1B,SAAnB,EAArB;AACA,aAAO,IAAP;AACA;AArGF;AAAA;AAAA,oCAuGiB;AACf;AACA,UAAI,KAAK9B,QAAL,KAAkB,CAAtB,EAAyB;AACxB,aAAK2B,QAAL,GAAgB,CAAhB;AACA,OAFD,MAEO;AACN;AACA,aAAKA,QAAL,GAAiB,IAAI,KAAK3B,QAAV,IAAuB,KAAK9B,KAAL,GAAa,KAAKA,KAAlB,GAA0B,KAAKD,MAAL,GAAc,KAAKA,MAApE,IAA8E,EAA9F;AACA,aAAK0D,QAAL,GAAgB,IAAI,KAAKA,QAAzB;AACA;AACD;AAhHF;AAAA;AAAA,8BAkHW2C,KAlHX,EAkHkB;AAChB,UAAIC,SAAS,GAAGD,KAAK,CAACtG,MAAN,CAAa4C,QAAb,CAAsB,KAAK5C,MAA3B,CAAhB;AACA,UAAIwG,IAAI,GAAG,KAAKlB,YAAL,GAAoBgB,KAAK,CAAChB,YAArC;AACA,UAAImB,IAAI,GAAGF,SAAS,CAACrI,MAAV,EAAX;;AACA,UAAIuI,IAAI,GAAGD,IAAX,EAAiB;AAChB;AACA,eAAO,KAAP;AACA;;AACD,aAAO,IAAP;AACA;AA3HF;AAAA;AAAA,6CA6H0BE,SA7H1B,EA6HqC5E,aA7HrC,EA6HoD;AAElD,UAAInC,CAAJ;AACA,UAAIgH,YAAJ;AAEA,UAAIC,YAAY,GAAG,MAAnB;AACA,UAAIC,SAAS,GAAG,IAAhB;AAEA,UAAIC,UAAU,GAAG,IAAjB;AACA,UAAI7I,CAAC,GAAG,CAAR;;AAEA,aAAQ6I,UAAD,IAAiB7I,CAAC,GAAG,KAAKuH,UAAL,CAAgBtH,MAA5C,EAAqD;AACpD;AACAyB,SAAC,GAAG,KAAK6F,UAAL,CAAgBvH,CAAhB,CAAJ,CAFoD,CAIpD;;AACA,YAAI8I,GAAG,GAAGpH,CAAC,CAACE,KAAF,CAAQ,CAAC,CAAT,CAAV;AACA,YAAImH,QAAQ,GAAG,KAAKxC,QAAL,CAAcvG,CAAd,CAAf,CANoD,CAOpD;AACA;;AACAyI,iBAAS,CAACO,gBAAV,CAA2BF,GAA3B,EAAgCC,QAAhC;AACAF,kBAAU,GAAII,UAAU,CAACC,aAAX,KAA6B,IAA3C,CAVoD,CAWpD;;AACA,YAAKL,UAAD,IAAiBI,UAAU,CAACE,iBAAX,GAA+BR,YAApD,EAAmE;AAClEA,sBAAY,GAAGM,UAAU,CAACE,iBAA1B;AACAP,mBAAS,GAAG5I,CAAZ;AACA0I,sBAAY,GAAGO,UAAU,CAACC,aAA1B;AACA;;AACDlJ,SAAC,GAAGA,CAAC,GAAG,CAAR;AACA;;AACD,UAAI6I,UAAJ,EAAgB;AACf;AACA,YAAIO,OAAO,GAAG,KAAK7B,UAAL,CAAgBqB,SAAhB,EAA2BhH,KAA3B,CAAiC+G,YAAjC,CAAd;AACA9E,qBAAa,CAACwF,OAAd,CAAsBV,YAAtB,EAAoC,KAAKpB,UAAL,CAAgBqB,SAAhB,CAApC,EAAgEF,YAAY,CAAC/G,GAAb,CAAiByH,OAAjB,CAAhE;AACA;;AAED,aAAOP,UAAP;AACA;AAlKF;AAAA;AAAA,qCAoKkBnE,EApKlB,EAoKsBE,EApKtB,EAoK0Bf,aApK1B,EAoKyC;AACvC,UAAIyF,eAAe,GAAG,IAAInI,4DAAJ,EAAtB;AACA,UAAIoI,eAAe,GAAG,IAAIpI,4DAAJ,EAAtB;AACA,UAAIqI,OAAO,GAAG,KAAd;AACA,UAAIC,OAAO,GAAG,KAAd,CAJuC,CAMvC;;AACAD,aAAO,GAAG9E,EAAE,CAACgF,wBAAH,CAA4B9E,EAA5B,EAAgC0E,eAAhC,CAAV;;AAEA,UAAIE,OAAJ,EAAa;AACZC,eAAO,GAAG7E,EAAE,CAAC8E,wBAAH,CAA4BhF,EAA5B,EAAgC6E,eAAhC,CAAV;;AACA,YAAIE,OAAJ,EAAa;AACZ;AACA,cAAIH,eAAe,CAACpF,QAAhB,KAA6BqF,eAAe,CAACrF,QAAhB,EAAjC,EAA6D;AAC5D,gBAAIyF,QAAQ,GAAGL,eAAe,CAAClF,SAAhB,GAA4BxC,KAA5B,CAAkC0H,eAAe,CAACpF,QAAhB,EAAlC,CAAf;AACAL,yBAAa,CAACwF,OAAd,CAAsBC,eAAe,CAACpF,QAAhB,EAAtB,EAAkDoF,eAAe,CAAClF,SAAhB,EAAlD,EAA+EkF,eAAe,CAAChI,MAAhB,CAAuBqD,QAAvB,CAAgCgF,QAAhC,CAA/E;AACA,WAHD,MAGO;AACN9F,yBAAa,CAACwF,OAAd,CAAsBE,eAAe,CAACrF,QAAhB,EAAtB,EAAkDqF,eAAe,CAACnF,SAAhB,GAA4BxC,KAA5B,CAAkC,CAAC,CAAnC,CAAlD,EAAyF2H,eAAe,CAACjI,MAAzG;AACA;AACD;AACD;;AACD,aAAOkI,OAAO,IAAIC,OAAlB;AACA;AA1LF;;AAAA;AAAA;;AA+LA,IAAIG,aAAa,GAAG,SAAhBA,aAAgB,GAAY;AAC5B,OAAKV,aAAL,GAAqB,IAArB;AACA,OAAKC,iBAAL,GAAyB,CAAzB;AACH,CAHD;;AAIA,IAAIF,UAAU,GAAG,IAAIW,aAAJ,EAAjB;;AAGA3C,SAAS,CAAC4C,SAAV,CAAoBb,gBAApB,GAAuC,UAAUF,GAAV,EAAeC,QAAf,EAAyB;AAC5D;AACA,MAAIe,OAAJ;AACA,MAAIC,UAAJ;AAEAd,YAAU,CAACE,iBAAX,GAA+B,CAAC,OAAhC;AACAF,YAAU,CAACC,aAAX,GAA2B,IAA3B,CAN4D,CAO5D;;AACA,OAAK,IAAIlJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKuG,QAAL,CAActG,MAAlC,EAA0CD,CAAC,EAA3C,EAA+C;AAC3C8J,WAAO,GAAG,KAAKvD,QAAL,CAAcvG,CAAd,EAAiB2E,QAAjB,CAA0BoE,QAA1B,CAAV;AACAgB,cAAU,GAAGD,OAAO,CAAC9E,GAAR,CAAY8D,GAAZ,CAAb,CAF2C,CAI3C;AACA;;AACA,QAAKiB,UAAU,GAAG,CAAd,IAAqBA,UAAU,GAAGd,UAAU,CAACE,iBAAjD,EAAqE;AACjEF,gBAAU,CAACC,aAAX,GAA2B,KAAK3C,QAAL,CAAcvG,CAAd,CAA3B;AACAiJ,gBAAU,CAACE,iBAAX,GAA+BY,UAA/B;AACH;AACP;AACD,CAnBD,C;;;;;;;;;;;;;;;;;;;;;AC9MA;AAEA,IAAM/K,OAAO,GAAG,GAAhB;AACA,IAAMgL,MAAM,GAAG,GAAf;AACA,IAAM/K,QAAQ,GAAG,GAAjB;AAEO,IAAMgL,QAAb;AACC,oBAAY9K,CAAZ,EAAeC,CAAf,EAAkB6C,KAAlB,EAAyBD,MAAzB,EAAiC;AAAA;;AAChC,SAAK7C,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA,SAAK6C,KAAL,GAAaA,KAAb;AACA,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKkI,MAAL,GAAc,EAAd;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,MAAL;AACA;;AATF;AAAA;AAAA,6BAWU;AACR,WAAKC,YAAL;AACC,WAAKC,eAAL,GAFO,CAGR;;AACC,WAAKC,YAAL,GAJO,CAKR;;AACA,WAAKC,YAAL;AACA,WAAKC,YAAL;AACA;AAnBF;AAAA;AAAA,6BAqBU;AACR,WAAKC,UAAL,CAAgB,KAAKvL,CAArB,EAAwB,KAAKC,CAA7B;AACA,WAAKsL,UAAL,CAAgB,KAAKvL,CAAL,GAAS,KAAK8C,KAA9B,EAAqC,KAAK7C,CAA1C;AACA,WAAKsL,UAAL,CAAgB,KAAKvL,CAAL,GAAS,KAAK8C,KAA9B,EAAqC,KAAK7C,CAAL,GAAS,KAAK4C,MAAnD;AACA,WAAK0I,UAAL,CAAgB,KAAKvL,CAArB,EAAwB,KAAKC,CAAL,GAAS,KAAK4C,MAAtC;AAEA,WAAK2I,UAAL,CAAgB,CAAhB,EAAmB,CAAnB;AACA,WAAKA,UAAL,CAAgB,CAAhB,EAAmB,CAAnB;AACA,WAAKA,UAAL,CAAgB,CAAhB,EAAmB,CAAnB;AACA,WAAKA,UAAL,CAAgB,CAAhB,EAAmB,CAAnB;AACA,WAAKA,UAAL,CAAgB,CAAhB,EAAmB,CAAnB;AACA,WAAKA,UAAL,CAAgB,CAAhB,EAAmB,CAAnB;AACA;AAjCF;AAAA;AAAA,+BAmCYC,EAnCZ,EAmCgBC,EAnChB,EAmCoB;AAClB,WAAKV,MAAL,CAAYW,IAAZ,CAAiB;AAChBC,UAAE,EAAE,KAAKb,MAAL,CAAYU,EAAZ,CADY;AAEhBA,UAAE,EAAE,KAAKV,MAAL,CAAYW,EAAZ,CAFY;AAGhB5K,cAAM,EAAE,KAAKE,QAAL,CAAc,KAAK+J,MAAL,CAAYU,EAAZ,CAAd,EAA+B,KAAKV,MAAL,CAAYW,EAAZ,CAA/B;AAHQ,OAAjB;AAKA;AAzCF;AAAA;AAAA,+BA2CYG,IA3CZ,EA2CkBC,IA3ClB,EA2CwB;AACtB,WAAKf,MAAL,CAAYY,IAAZ,CAAiB;AAChB3L,SAAC,EAAE6L,IADa;AAEhB5L,SAAC,EAAE6L,IAFa;AAGhBC,YAAI,EAAEF,IAAI,GAAGlK,IAAI,CAACqK,MAAL,KAAgB,EAAvB,GAA4B,EAHlB;AAIhBC,YAAI,EAAEH,IAAI,GAAGnK,IAAI,CAACqK,MAAL,KAAgB,EAAvB,GAA4B;AAJlB,OAAjB;AAMA;AAlDF;AAAA;AAAA,6BAoDUJ,EApDV,EAoDcH,EApDd,EAoDkB;AAChB,UAAIvL,EAAE,GAAGuL,EAAE,CAACzL,CAAH,GAAO4L,EAAE,CAAC5L,CAAnB;AAAA,UACCG,EAAE,GAAGsL,EAAE,CAACxL,CAAH,GAAO2L,EAAE,CAAC3L,CADhB;AAEA,aAAO0B,IAAI,CAACwG,IAAL,CAAUjI,EAAE,GAAGA,EAAL,GAAUC,EAAE,GAAGA,EAAzB,CAAP;AACA;AAxDF;AAAA;AAAA,mCA0DgB;AACd,WAAI,IAAIU,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,KAAKkK,MAAL,CAAYjK,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC3C,YAAIyE,CAAC,GAAG,KAAKyF,MAAL,CAAYlK,CAAZ,CAAR;AACA,YAAIqL,EAAE,GAAG,CAAC5G,CAAC,CAACtF,CAAF,GAAMsF,CAAC,CAACyG,IAAT,IAAiBjM,QAA1B;AACA,YAAIqM,EAAE,GAAG,CAAC7G,CAAC,CAACrF,CAAF,GAAMqF,CAAC,CAAC2G,IAAT,IAAiBnM,QAA1B;AAEAwF,SAAC,CAACyG,IAAF,GAASzG,CAAC,CAACtF,CAAX;AACAsF,SAAC,CAAC2G,IAAF,GAAS3G,CAAC,CAACrF,CAAX;AACAqF,SAAC,CAACtF,CAAF,IAAOkM,EAAP;AACA5G,SAAC,CAACrF,CAAF,IAAOkM,EAAP;AACA7G,SAAC,CAACrF,CAAF,IAAOJ,OAAP;AACA;AACD;AAtEF;AAAA;AAAA,sCAwEmB;AACjB,WAAI,IAAIgB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,KAAKkK,MAAL,CAAYjK,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC3C,YAAIyE,CAAC,GAAG,KAAKyF,MAAL,CAAYlK,CAAZ,CAAR;AAAA,YACCqL,EAAE,GAAG,CAAC5G,CAAC,CAACtF,CAAF,GAAMsF,CAAC,CAACyG,IAAT,IAAiBjM,QADvB;AAAA,YAECqM,EAAE,GAAG,CAAC7G,CAAC,CAACrF,CAAF,GAAMqF,CAAC,CAAC2G,IAAT,IAAiBnM,QAFvB;;AAIA,YAAGwF,CAAC,CAACtF,CAAF,GAAMwH,8CAAM,CAAC1E,KAAhB,EAAuB;AACtBwC,WAAC,CAACtF,CAAF,GAAMwH,8CAAM,CAAC1E,KAAb;AACAwC,WAAC,CAACyG,IAAF,GAASzG,CAAC,CAACtF,CAAF,GAAMkM,EAAE,GAAGrB,MAApB;AACA,SAHD,MAIK,IAAGvF,CAAC,CAACtF,CAAF,GAAM,CAAT,EAAY;AAChBsF,WAAC,CAACtF,CAAF,GAAM,CAAN;AACAsF,WAAC,CAACyG,IAAF,GAASzG,CAAC,CAACtF,CAAF,GAAMkM,EAAE,GAAGrB,MAApB;AACA;;AACD,YAAGvF,CAAC,CAACrF,CAAF,GAAMuH,8CAAM,CAAC3E,MAAhB,EAAwB;AACvByC,WAAC,CAACrF,CAAF,GAAMuH,8CAAM,CAAC3E,MAAb;AACAyC,WAAC,CAAC2G,IAAF,GAAS3G,CAAC,CAACrF,CAAF,GAAMkM,EAAE,GAAGtB,MAApB;AACA,SAHD,MAIK,IAAGvF,CAAC,CAACrF,CAAF,GAAM,CAAT,EAAY;AAChBqF,WAAC,CAACrF,CAAF,GAAM,CAAN;AACAqF,WAAC,CAAC2G,IAAF,GAAS3G,CAAC,CAACrF,CAAF,GAAMkM,EAAE,GAAGtB,MAApB;AACA;AACD;AACD;AA/FF;AAAA;AAAA,mCAiGgB;AACd,WAAI,IAAIhK,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,KAAKmK,MAAL,CAAYlK,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC3C,YAAIwB,CAAC,GAAG,KAAK2I,MAAL,CAAYnK,CAAZ,CAAR;AAAA,YACCX,EAAE,GAAGmC,CAAC,CAACoJ,EAAF,CAAKzL,CAAL,GAASqC,CAAC,CAACuJ,EAAF,CAAK5L,CADpB;AAAA,YAECG,EAAE,GAAGkC,CAAC,CAACoJ,EAAF,CAAKxL,CAAL,GAASoC,CAAC,CAACuJ,EAAF,CAAK3L,CAFpB;AAAA,YAGCe,QAAQ,GAAGW,IAAI,CAACwG,IAAL,CAAUjI,EAAE,GAAGA,EAAL,GAAUC,EAAE,GAAGA,EAAzB,CAHZ;AAAA,YAICiM,UAAU,GAAG/J,CAAC,CAACvB,MAAF,GAAWE,QAJzB;AAAA,YAKCqL,OAAO,GAAGD,UAAU,GAAGpL,QAAb,GAAwB,CALnC;AAAA,YAMCsL,OAAO,GAAGpM,EAAE,GAAGmM,OANhB;AAAA,YAOCE,OAAO,GAAGpM,EAAE,GAAGkM,OAPhB;AASAhK,SAAC,CAACuJ,EAAF,CAAK5L,CAAL,IAAUsM,OAAV;AACAjK,SAAC,CAACuJ,EAAF,CAAK3L,CAAL,IAAUsM,OAAV;AACAlK,SAAC,CAACoJ,EAAF,CAAKzL,CAAL,IAAUsM,OAAV;AACAjK,SAAC,CAACoJ,EAAF,CAAKxL,CAAL,IAAUsM,OAAV;AACA;AACD;AAjHF;AAAA;AAAA,mCAmHgB,CACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5HF;AAAA;AAAA,mCA8HgB;AACd/K,+CAAC,CAACC,SAAF;;AACA,WAAI,IAAIZ,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,KAAKmK,MAAL,CAAYlK,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC3C,YAAIwB,CAAC,GAAG,KAAK2I,MAAL,CAAYnK,CAAZ,CAAR;AACAW,iDAAC,CAACgL,MAAF,CAASnK,CAAC,CAACuJ,EAAF,CAAK5L,CAAd,EAAiBqC,CAAC,CAACuJ,EAAF,CAAK3L,CAAtB;AACAuB,iDAAC,CAACiL,MAAF,CAASpK,CAAC,CAACoJ,EAAF,CAAKzL,CAAd,EAAiBqC,CAAC,CAACoJ,EAAF,CAAKxL,CAAtB;AACAuB,iDAAC,CAACK,WAAF,GAAgB,KAAhB;AACA;;AACDL,+CAAC,CAACM,MAAF;AACAN,+CAAC,CAACO,SAAF;AACA;AAxIF;;AAAA;AAAA,I;;;;;;;;;;;;;;;;;;;;ACLO,IAAMvB,IAAb;AACC,gBAAYR,CAAZ,EAAeC,CAAf,EAAkB;AAAA;;AACjB,SAAKD,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA;;AAJF;AAAA;AAAA,6BAMU;AACR,aAAO0B,IAAI,CAACwG,IAAL,CAAU,KAAKnI,CAAL,GAAS,KAAKA,CAAd,GAAkB,KAAKC,CAAL,GAAS,KAAKA,CAA1C,CAAP;AACA;AARF;AAAA;AAAA,wBAUKyM,GAVL,EAUU;AACR,aAAO,IAAIlM,IAAJ,CAASkM,GAAG,CAAC1M,CAAJ,GAAQ,KAAKA,CAAtB,EAAyB0M,GAAG,CAACzM,CAAJ,GAAQ,KAAKA,CAAtC,CAAP;AACA;AAZF;AAAA;AAAA,6BAcUyM,GAdV,EAce;AACb,aAAO,IAAIlM,IAAJ,CAAS,KAAKR,CAAL,GAAS0M,GAAG,CAAC1M,CAAtB,EAAyB,KAAKC,CAAL,GAASyM,GAAG,CAACzM,CAAtC,CAAP;AACA;AAhBF;AAAA;AAAA,0BAkBOsC,CAlBP,EAkBU;AACR,aAAO,IAAI/B,IAAJ,CAAS,KAAKR,CAAL,GAASuC,CAAlB,EAAqB,KAAKtC,CAAL,GAASsC,CAA9B,CAAP;AACA;AApBF;AAAA;AAAA,wBAsBKmK,GAtBL,EAsBU;AACR,aAAQ,KAAK1M,CAAL,GAAS0M,GAAG,CAAC1M,CAAb,GAAiB,KAAKC,CAAL,GAASyM,GAAG,CAACzM,CAAtC;AACA;AAxBF;AAAA;AAAA,0BA0BOyM,GA1BP,EA0BY;AACV,aAAQ,KAAK1M,CAAL,GAAS0M,GAAG,CAACzM,CAAb,GAAiB,KAAKA,CAAL,GAASyM,GAAG,CAAC1M,CAAtC;AACA;AA5BF;AAAA;AAAA,gCA8Ba;AACX,UAAI2M,GAAG,GAAG,KAAK7L,MAAL,EAAV;;AACA,UAAI6L,GAAG,GAAG,CAAV,EAAa;AACZA,WAAG,GAAG,IAAIA,GAAV;AACA;;AACD,aAAO,IAAInM,IAAJ,CAAS,KAAKR,CAAL,GAAS2M,GAAlB,EAAuB,KAAK1M,CAAL,GAAS0M,GAAhC,CAAP;AACA;AApCF;AAAA;AAAA,2BAsCQ/J,MAtCR,EAsCgBa,KAtChB,EAsCuB;AACrB;AACA,UAAImJ,CAAC,GAAG,EAAR;AAEA,UAAI5M,CAAC,GAAG,KAAKA,CAAL,GAAS4C,MAAM,CAAC5C,CAAxB;AACA,UAAIC,CAAC,GAAG,KAAKA,CAAL,GAAS2C,MAAM,CAAC3C,CAAxB;AAEA2M,OAAC,CAAC,CAAD,CAAD,GAAO5M,CAAC,GAAG2B,IAAI,CAAC0C,GAAL,CAASZ,KAAT,CAAJ,GAAsBxD,CAAC,GAAG0B,IAAI,CAAC2C,GAAL,CAASb,KAAT,CAAjC;AACAmJ,OAAC,CAAC,CAAD,CAAD,GAAO5M,CAAC,GAAG2B,IAAI,CAAC2C,GAAL,CAASb,KAAT,CAAJ,GAAsBxD,CAAC,GAAG0B,IAAI,CAAC0C,GAAL,CAASZ,KAAT,CAAjC;AAEAmJ,OAAC,CAAC,CAAD,CAAD,IAAQhK,MAAM,CAAC5C,CAAf;AACA4M,OAAC,CAAC,CAAD,CAAD,IAAQhK,MAAM,CAAC3C,CAAf;AAEA,aAAO,IAAIO,IAAJ,CAASoM,CAAC,CAAC,CAAD,CAAV,EAAeA,CAAC,CAAC,CAAD,CAAhB,CAAP;AACA;AApDF;AAAA;AAAA,6BAsDUF,GAtDV,EAsDe;AACb,UAAI1M,CAAC,GAAG,KAAKA,CAAL,GAAS0M,GAAG,CAAC1M,CAArB;AACA,UAAIC,CAAC,GAAG,KAAKA,CAAL,GAASyM,GAAG,CAACzM,CAArB;AACA,aAAO0B,IAAI,CAACwG,IAAL,CAAUnI,CAAC,GAAGA,CAAJ,GAAQC,CAAC,GAAGA,CAAtB,CAAP;AACA;AA1DF;;AAAA;AAAA,I;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDA;AACA;AACA;AACA;AACA;AACA;AAEO,IAAMuH,MAAM,GAAGqF,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACA,IAAMtL,CAAC,GAAGgG,MAAM,CAACuF,UAAP,CAAkB,IAAlB,CAAV;AAEPvF,MAAM,CAAC1E,KAAP,GAAezB,UAAf;AACAmG,MAAM,CAAC3E,MAAP,GAAgBvB,WAAhB;AAEA,IAAI0L,SAAS,GAAG,KAAhB;AACA,IAAIjG,MAAM,GAAG,KAAb;AACA,IAAIkG,IAAI,GAAG,EAAX;AACA,IAAMC,KAAK,GAAG;AACZlN,GAAC,EAAEqB,UAAU,GAAG,CADJ;AAEZpB,GAAC,EAAEqB,WAAW,GAAG;AAFL,CAAd;AAKA;;IACM6L,I;AACJ,gBAAYnN,CAAZ,EAAeC,CAAf,EAAkBmN,GAAlB,EAAuBC,GAAvB,EAA4B;AAAA;;AAC1B,SAAKrN,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA,SAAKmN,GAAL,GAAWA,GAAX;AACA,SAAKC,GAAL,GAAWA,GAAX;AACD;;;;6BAEQ;AACP,WAAK9L,IAAL;AACD;;;2BAEM;AACLC,OAAC,CAACC,SAAF;AACAD,OAAC,CAACgL,MAAF,CAAS,KAAKxM,CAAd,EAAiB,KAAKC,CAAtB;AACAuB,OAAC,CAACiL,MAAF,CAASS,KAAK,CAAClN,CAAf,EAAkBkN,KAAK,CAACjN,CAAxB;AACAuB,OAAC,CAACM,MAAF;AACAN,OAAC,CAACK,WAAF,GAAgB,OAAhB;AACD;;;;;;AAGH,IAAMyL,MAAM,GAAG,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,CAAf,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,gBAAgB,CAAC,SAAD,EAAY,UAACC,KAAD,EAAW;AACrC7K,QAAM,CAAC8K,QAAP,CAAgBD,KAAK,CAACnG,GAAtB,EAA2B,IAA3B;AACD,CAFe,CAAhB;AAIAkG,gBAAgB,CAAC,OAAD,EAAU,UAACC,KAAD,EAAW;AACnC7K,QAAM,CAAC8K,QAAP,CAAgBD,KAAK,CAACnG,GAAtB,EAA2B,KAA3B;AACD,CAFe,CAAhB;AAMAkG,gBAAgB,CAAC,QAAD,EAAW,YAAM;AAC/B/F,QAAM,CAAC1E,KAAP,GAAezB,UAAf;AACAmG,QAAM,CAAC3E,MAAP,GAAgBvB,WAAhB;AACAmG,MAAI;AACL,CAJe,CAAhB;AAMA,IAAIiG,MAAM,GAAG,IAAb;AACA,IAAIC,KAAK,GAAG;AACV3N,GAAC,EAAE,IADO;AAEVC,GAAC,EAAE,IAFO;AAGV6C,OAAK,EAAE,IAHG;AAIVD,QAAM,EAAE;AAJE,CAAZ;AAOA0K,gBAAgB,CAAC,WAAD,EAAc,UAACC,KAAD,EAAW;AACvCN,OAAK,CAAClN,CAAN,GAAUwN,KAAK,CAACI,OAAhB;AACAV,OAAK,CAACjN,CAAN,GAAUuN,KAAK,CAACK,OAAhB;AACAH,QAAM,GAAG,IAAI5F,oDAAJ,CAAc,IAAItH,0CAAJ,CAAS0M,KAAK,CAAClN,CAAf,EAAkBkN,KAAK,CAACjN,CAAxB,CAAd,EAA0C,GAA1C,EAA+C,EAA/C,EAAmD,IAAIO,0CAAJ,CAAS,CAAT,EAAW,CAAX,CAAnD,EAAkE,QAAlE,EAA4E,CAA5E,EAA+E,KAA/E,CAAT;AACAuG,QAAM,GAAG,IAAT;AACD,CALe,CAAhB;AAOAwG,gBAAgB,CAAC,SAAD,EAAY,UAACC,KAAD,EAAW;AACrCzG,QAAM,GAAG,KAAT;AACApG,WAAS,CAACgL,IAAV,CAAe+B,MAAf;AACAA,QAAM,GAAG,IAAT;AACD,CAJe,CAAhB,C,CASA;;AACA,IAAInG,SAAS,GAAG,EAAhB;AACA,IAAI5G,SAAS,GAAG,EAAhB;AACA,IAAIgC,MAAM,GAAG,IAAb;AACA,IAAImL,SAAS,GAAG,IAAhB;AAEO,SAASrG,IAAT,GAAgB;AACrBF,WAAS,GAAG,EAAZ;AACAuG,WAAS,GAAG,IAAIhD,kDAAJ,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,EAA4B,GAA5B,CAAZ;AACAnI,QAAM,GAAG,IAAImE,8CAAJ,CAAW,IAAItG,0CAAJ,CAASgH,MAAM,CAAC1E,KAAP,GAAe,CAAxB,EAA2B0E,MAAM,CAAC3E,MAAP,GAAgB,CAA3C,CAAX,EAA0D,EAA1D,EAA8D,EAA9D,EAAkE,IAAIrC,0CAAJ,CAAS,CAAT,EAAY,CAAZ,CAAlE,EAAkF,MAAlF,EAA0F,CAA1F,CAAT;AACA,GAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAwBuN,GAAxB,CAA4B,YAAM;AAChCpN,aAAS,CAACgL,IAAV,CAAe,IAAI7D,oDAAJ,CAAc,IAAItH,0CAAJ,CAASwN,6CAAK,CAACC,kBAAN,CAAyB,CAAzB,EAA4BzG,MAAM,CAAC1E,KAAnC,CAAT,EAAoDkL,6CAAK,CAACC,kBAAN,CAAyB,CAAzB,EAA4BzG,MAAM,CAAC3E,MAAnC,CAApD,CAAd,EAA+G,GAA/G,EAAoH,EAApH,EAAwH,IAAIrC,0CAAJ,CAASwN,6CAAK,CAACC,kBAAN,CAAyB,CAAC,EAA1B,EAA8B,EAA9B,CAAT,EAA4CD,6CAAK,CAACC,kBAAN,CAAyB,CAAC,EAA1B,EAA8B,EAA9B,CAA5C,CAAxH,EAAwM,OAAxM,EAAiND,6CAAK,CAACC,kBAAN,CAAyB,CAAzB,EAA4B,CAA5B,CAAjN,EAAiP,IAAjP,CAAf;AACD,GAFD;AAGAtN,WAAS,CAACgL,IAAV,CAAe,IAAI7D,oDAAJ,CAAc,IAAItH,0CAAJ,CAASgH,MAAM,CAAC1E,KAAP,GAAe,CAAxB,EAA2B0E,MAAM,CAAC3E,MAAP,GAAgB,CAA3C,CAAd,EAA6D,GAA7D,EAAkE,EAAlE,EAAsE,IAAIrC,0CAAJ,CAAS,CAAT,EAAY,CAAZ,CAAtE,EAAsF,OAAtF,EAA+F,CAA/F,EAAkG,KAAlG,CAAf,EAPqB,CASrB;AACA;;AAED,OAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC3B,QAAIT,MAAM,GAAG,EAAb;AACA,QAAIJ,CAAC,GAAGgO,6CAAK,CAACC,kBAAN,CAAyB7N,MAAzB,EAAiCoH,MAAM,CAAC1E,KAAP,GAAe1C,MAAhD,CAAR;AACA,QAAIH,CAAC,GAAG+N,6CAAK,CAACC,kBAAN,CAAyB7N,MAAzB,EAAiCoH,MAAM,CAAC3E,MAAP,GAAgBzC,MAAjD,CAAR;AACA,QAAIF,EAAE,GAAG8N,6CAAK,CAACC,kBAAN,CAAyB,CAAC,CAA1B,EAA6B,CAA7B,CAAT;AACA,QAAI9N,EAAE,GAAG6N,6CAAK,CAACC,kBAAN,CAAyB,CAAC,CAA1B,EAA6B,CAA7B,CAAT;;AAEE,QAAKpN,CAAC,KAAK,CAAX,EAAc;AACZ,WAAK,IAAIqN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG3G,SAAS,CAACzG,MAA9B,EAAsCoN,CAAC,EAAvC,EAA2C;AACvC,YAAMnN,IAAI,GAAGwG,SAAS,CAAC2G,CAAD,CAAtB;;AACA,YAAIlN,QAAQ,CAAChB,CAAD,EAAIC,CAAJ,EAAOc,IAAI,CAACf,CAAZ,EAAee,IAAI,CAACd,CAApB,CAAR,GAAkCG,MAAM,GAAG,CAA5C,GAAmD,CAAtD,EAAyD;AACvD,cAAIJ,CAAC,GAAGgO,6CAAK,CAACC,kBAAN,CAAyB7N,MAAzB,EAAiCoH,MAAM,CAAC1E,KAAP,GAAe1C,MAAhD,CAAR;AACA,cAAIH,CAAC,GAAG+N,6CAAK,CAACC,kBAAN,CAAyB7N,MAAzB,EAAiCoH,MAAM,CAAC3E,MAAP,GAAgBzC,MAAjD,CAAR;AAEA8N,WAAC,GAAG,CAAC,CAAL;AACD;AACJ;AACF;;AAED3G,aAAS,CAACoE,IAAV,CAAe,IAAI5L,0CAAJ,CAASC,CAAT,EAAYC,CAAZ,EAAeC,EAAf,EAAmBC,EAAnB,EAAuBC,MAAvB,EAA+B,MAA/B,EAAuC,KAAvC,CAAf;AACF;AACD;AAEM,SAASY,QAAT,CAAkBmN,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkC;AACvC,MAAM/K,KAAK,GAAG8K,EAAE,GAAGF,EAAnB;AACA,MAAM3K,KAAK,GAAG8K,EAAE,GAAGF,EAAnB;AACA,SAAOzM,IAAI,CAACwG,IAAL,CAAUxG,IAAI,CAAC4M,GAAL,CAAShL,KAAT,EAAgB,CAAhB,IAAqB5B,IAAI,CAAC4M,GAAL,CAAS/K,KAAT,EAAgB,CAAhB,CAA/B,CAAP;AACD,C,CAED;;AACA,SAASgL,OAAT,GAAmB;AACjBC,uBAAqB,CAACD,OAAD,CAArB;AACAhN,GAAC,CAACkN,SAAF,CAAY,CAAZ,EAAe,CAAf,EAAkBlH,MAAM,CAAC1E,KAAzB,EAAgC0E,MAAM,CAAC3E,MAAvC;AAEA0E,WAAS,CAACoH,OAAV,CAAkB,UAAAxL,IAAI,EAAI;AACzBA,QAAI,CAACyL,MAAL,CAAYrH,SAAZ,EAAuB5G,SAAvB;AACA,GAFD;;AAIA,MAAIsM,IAAJ,EAAU;AACRA,QAAI,CAAC0B,OAAL,CAAa,UAAAE,EAAE,EAAI;AACjBA,QAAE,CAACD,MAAH;AACD,KAFD;AAGD;;AACDjO,WAAS,CAACgO,OAAV,CAAkB,UAACzN,IAAD,EAAU;AAC1BA,QAAI,CAAC0N,MAAL,CAAYjO,SAAZ,EAAuB4G,SAAvB;AACD,GAFD,EAbiB,CAiBjB;AACA;AAEA;AACA;AACA;AACD;;AAGDE,IAAI;AACJ+G,OAAO,G;;;;;;;;;;;ACxKP,SAASP,kBAAT,CAA4BlI,GAA5B,EAAiC+I,GAAjC,EAAsC;AACpC,SAAOnN,IAAI,CAACoN,KAAL,CAAWpN,IAAI,CAACqK,MAAL,MAAiB8C,GAAG,GAAG/I,GAAN,GAAY,CAA7B,IAAkCA,GAA7C,CAAP;AACD;;AAED,SAASiJ,WAAT,CAAqB1B,MAArB,EAA6B;AAC3B,SAAOA,MAAM,CAAC3L,IAAI,CAACoN,KAAL,CAAWpN,IAAI,CAACqK,MAAL,KAAgBsB,MAAM,CAACxM,MAAlC,CAAD,CAAb;AACD;;AAED,SAASE,QAAT,CAAkBmN,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkC;AAChC,MAAM/K,KAAK,GAAG8K,EAAE,GAAGF,EAAnB;AACA,MAAM3K,KAAK,GAAG8K,EAAE,GAAGF,EAAnB;AAEA,SAAOzM,IAAI,CAACwG,IAAL,CAAUxG,IAAI,CAAC4M,GAAL,CAAShL,KAAT,EAAgB,CAAhB,IAAqB5B,IAAI,CAAC4M,GAAL,CAAS/K,KAAT,EAAgB,CAAhB,CAA/B,CAAP;AACD;;AAEDyL,MAAM,CAACC,OAAP,GAAiB;AAAEjB,oBAAkB,EAAlBA,kBAAF;AAAsBe,aAAW,EAAXA,WAAtB;AAAmChO,UAAQ,EAARA;AAAnC,CAAjB,C","file":"./js/canvas.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/js/canvas.js\");\n","import { distance, c, canvas } from './canvas';\r\nimport { ballToBallCollision, rectCircleCollision, circleRectCollisionResponse } from './Engine';\r\nimport { Vec2 } from './Vec2';\r\n\r\nvar gravity = 0.2;\r\nvar friction = 0.7;\r\n\r\nexport class Ball {\r\n\tconstructor(x, y, dx, dy, radius, color, placeHolder) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.velocity = new Vec2(dx, dy);\r\n\t\tthis.radius = radius;\r\n\t\tthis.color = color;\r\n\t\tthis.mass = 1;\r\n\t\tthis.placeHolder = placeHolder;\r\n\t}\r\n\r\n\r\n\tupdate(balls, rectArray) {\r\n\t\tif (!this.placeHolder) {\r\n\t\t\tlet coll = false;\r\n\t\t\tfor (let i = 0; i < balls.length; i++) {\r\n\t\t\t\tif (this === balls[i] || balls[i].placeHolder) continue;\r\n\t\t\t\tconst prev = balls[i];\r\n\t\t\t\tif (distance(this.x + this.velocity.x, this.y + this.velocity.y, prev.x, prev.y) - this.radius * 2  < 0) {\r\n\t\t\t\t\tballToBallCollision(this, balls[i]);\r\n\t\t\t\t\tcoll = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor(let rect of rectArray) {\r\n\t\t\t\tif (rectCircleCollision(rect, this)) {\r\n\t\t\t\t\tcircleRectCollisionResponse(rect, this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (this.x - this.radius <= 0 || this.x + this.radius >= innerWidth) {\r\n\t\t\t\tthis.velocity.x = - this.velocity.x;\r\n\t\t\t}\r\n\t\t\tif ((this.y - this.radius) + this.velocity.y <= 0 || (this.y + this.radius) + this.velocity.y >= innerHeight) {\r\n\t\t\t\tthis.velocity.y = - this.velocity.y;\r\n\t\t\t\tthis.velocity.y = this.velocity.y * friction;\r\n\t\t\t\tthis.velocity.x = this.velocity.x * friction;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!coll) {\r\n\t\t\t\t\tthis.velocity.y += gravity;\r\n\t\t\t\t} else {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.x += this.velocity.x;\r\n\t\t\tthis.y += this.velocity.y;\r\n\t\t}\r\n\r\n\t\tthis.draw();\r\n\t};\r\n\r\n\tdraw() {\r\n\t\tc.beginPath();\r\n\t\tc.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);\t\r\n\t\tc.strokeStyle = this.color;\r\n\t\tc.stroke();\r\n\t\tc.closePath();\r\n\t};\r\n}\r\n","import { Vec2 } from \"./Vec2\";\r\n\r\nexport class CollisionInfo {\r\n\tconstructor() {\r\n\t\tthis.mDepth = 0;\r\n\t\tthis.mNormal = new Vec2(0, 0);\r\n\t\tthis.mStart = new Vec2(0, 0);\r\n\t\tthis.mEnd = new Vec2(0, 0);\r\n\t}\r\n\t\r\n\tsetDepth(s) {\r\n\t\tthis.mDepth = s;\r\n\t};\r\n\r\n\tsetNormal(s) {\r\n\t\tthis.mNormal = s;\r\n\t};\r\n\r\n\tgetDepth() {\r\n\t\treturn this.mDepth;\r\n\t};\r\n\r\n\tgetNormal() {\r\n\t\treturn this.mNormal;\r\n\t};\r\n\r\n\tsetInfo(d, n, s) {\r\n\t\tthis.mDepth = d;\r\n\t\tthis.mNormal = n;\r\n\t\tthis.mStart = s;\r\n\t\tthis.mEnd = s.add(n.scale(d));\r\n\t};\r\n\r\n\tchangeDir() {\r\n\t\tthis.mNormal = this.mNormal.scale(-1);\r\n\t\tvar n = this.mStart;\r\n\t\tthis.mStart = this.mEnd;\r\n\t\tthis.mEnd = n;\r\n\t};\r\n}","import { Vec2 } from \"./Vec2\";\r\n\r\n\r\nexport const playerRectCollision = (player, rect) => {\r\n\tif (player.velocity.y >= 0\r\n\t\t&&player.center.y + player.height + player.velocity.y >= rect.center.y - rect.height / 2\r\n\t\t&& player.center.y - player.height <= rect.center.y\r\n\t\t&& player.center.x <= rect.center.x + rect.width - player.width\r\n\t\t&& player.center.x + player.width >= rect.center.x) {\r\n\t\t\tplayer.center.y = rect.center.y - player.height - rect.height / 2;\r\n\t\t\tplayer.velocity.y = 0;\r\n\t}\r\n} \r\n\r\nexport const rectCircleCollision = (player, circle) => {\r\n\tconst distX = Math.abs(circle.x - player.center.x - player.width / 2);\r\n\tconst distY = Math.abs(circle.y - player.center.y - player.height / 2);\r\n\r\n\tif (distX > (player.width / 2 + circle.radius)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (distY > (player.height / 2 + circle.radius)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (distX <= (player.width / 2)) {\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\tif (distY <= (player.height / 2)) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tconst dx = distX - player.width / 2;\r\n\tconst dy = distY - player.height / 2;\r\n\treturn (dx*dx+dy*dy <= (circle.radius*circle.radius));\r\n}\r\n\r\nexport const circleRectCollisionResponse = (rect, circle) => {\r\n\t\r\n}\r\n\r\nexport const ballToBallCollision = (ball, otherBall) => {\r\n    const xVelocityDiff = ball.velocity.x - otherBall.velocity.x;\r\n    const yVelocityDiff = ball.velocity.y - otherBall.velocity.y;\r\n\r\n    const xDist = otherBall.x - ball.x;\r\n    const yDist = otherBall.y - ball.y;\r\n\r\n    // Prevent accidental overlap of particles\r\n    if (xVelocityDiff * xDist + yVelocityDiff * yDist >= 0) {\r\n\r\n        // Grab angle between the two colliding particles\r\n        const angle = -Math.atan2(otherBall.y - ball.y, otherBall.x - ball.x);\r\n\r\n        // Store mass in var for better readability in collision equation\r\n        const m1 = ball.mass;\r\n        const m2 = otherBall.mass;\r\n\r\n        // Velocity before equation\r\n        const u1 = rotate(ball.velocity, angle);\r\n        const u2 = rotate(otherBall.velocity, angle);\r\n\r\n        // Velocity after 1d collision equation\r\n        const v1 = { x: u1.x * (m1 - m2) / (m1 + m2) + u2.x * 2 * m2 / (m1 + m2), y: u1.y };\r\n        const v2 = { x: u2.x * (m1 - m2) / (m1 + m2) + u1.x * 2 * m2 / (m1 + m2), y: u2.y };\r\n\r\n        // Final velocity after rotating axis back to original location\r\n        const vFinal1 = rotate(v1, -angle);\r\n        const vFinal2 = rotate(v2, -angle);\r\n\r\n        // Swap particle velocities for realistic bounce effect\r\n        ball.velocity.x = vFinal1.x;\r\n        ball.velocity.y = vFinal1.y;\r\n\r\n        otherBall.velocity.x = vFinal2.x;\r\n        otherBall.velocity.y = vFinal2.y;\r\n    }\r\n}\r\n\r\nconst rotate = (velocity, angle) => {\r\n    const rotatedVelocities = {\r\n        x: velocity.x * Math.cos(angle) - velocity.y * Math.sin(angle),\r\n        y: velocity.x * Math.sin(angle) + velocity.y * Math.cos(angle)\r\n    };\r\n\r\n    return rotatedVelocities;\r\n}\r\n\r\nvar positionalCorrection = function (s1, s2, collisionInfo) {\r\n\tvar s1InvMass = s1.mInvMass;\r\n\tvar s2InvMass = s2.mInvMass;\r\n\r\n\tvar num = collisionInfo.getDepth() / (s1InvMass + s2InvMass) * 0.8;\r\n\tvar correctionAmount = collisionInfo.getNormal().scale(num);\r\n\r\n\ts1.move(correctionAmount.scale(-s1InvMass));\r\n\ts2.move(correctionAmount.scale(s2InvMass));\r\n};\r\n\r\nexport const resolveCollision = function (s1, s2, collisionInfo) {\r\n\tif ((s1.mInvMass === 0) && (s2.mInvMass === 0)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tpositionalCorrection(s1, s2, collisionInfo);\r\n\r\n\tvar n = collisionInfo.getNormal();\r\n\r\n\t//the direction of collisionInfo is always from s1 to s2\r\n\t//but the Mass is inversed, so start scale with s2 and end scale with s1\r\n\tvar start = collisionInfo.mStart.scale(s2.mInvMass / (s1.mInvMass + s2.mInvMass));\r\n\tvar end = collisionInfo.mEnd.scale(s1.mInvMass / (s1.mInvMass + s2.mInvMass));\r\n\tvar p = start.add(end);\r\n\t//r is vector from center of object to collision point\r\n\tvar r1 = p.subtract(s1.center);\r\n\tvar r2 = p.subtract(s2.center);\r\n\r\n\t//newV = V + mAngularVelocity cross R\r\n\tvar v1 = s1.velocity.add(new Vec2(-1 * s1.angularVelocity * r1.y, s1.angularVelocity * r1.x));\r\n\tvar v2 = s2.velocity.add(new Vec2(-1 * s2.angularVelocity * r2.y, s2.angularVelocity * r2.x));\r\n\r\n\tvar relativeVelocity = v2.subtract(v1);\r\n\r\n\t// Relative velocity in normal direction\r\n\tvar rVelocityInNormal = relativeVelocity.dot(n);\r\n\r\n\t//if objects moving apart ignore\r\n\tif (rVelocityInNormal > 0) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// compute and apply response impulses for each object    \r\n\tvar newRestituion = Math.min(s1.mRestitution, s2.mRestitution);\r\n\tvar newFriction = Math.min(s1.mFriction, s2.mFriction);\r\n\r\n\t//R cross N\r\n\tvar R1crossN = r1.cross(n);\r\n\tvar R2crossN = r2.cross(n);\r\n\r\n\r\n\t// Calc impulse scalar\r\n\t// the formula of jN can be found in http://www.myphysicslab.com/collision.html\r\n\tvar jN = -(1 + newRestituion) * rVelocityInNormal;\r\n\tjN = jN / (s1.mInvMass + s2.mInvMass +\r\n\t\t\tR1crossN * R1crossN * s1.mInertia +\r\n\t\t\tR2crossN * R2crossN * s2.mInertia);\r\n\r\n\t//impulse is in direction of normal ( from s1 to s2)\r\n\tvar impulse = n.scale(jN);\r\n\r\n\t// impulse = F dt = m * ?v\r\n\t// ?v = impulse / m\r\n\ts1.velocity = s1.velocity.subtract(impulse.scale(1));\r\n\ts2.velocity = s2.velocity.add(impulse.scale(1));\r\n\r\n\ts1.angularVelocity -= R1crossN * jN * s1.mInertia;\r\n\ts2.angularVelocity += R2crossN * jN * s2.mInertia;\r\n\r\n\tvar tangent = relativeVelocity.subtract(n.scale(relativeVelocity.dot(n)));\r\n\r\n\t//relativeVelocity.dot(tangent) should less than 0\r\n\ttangent = tangent.normalize().scale(-1);\r\n\r\n\r\n\tvar R1crossT = r1.cross(tangent);\r\n\tvar R2crossT = r2.cross(tangent);\r\n\r\n\r\n\tvar jT = -(1 + newRestituion) * relativeVelocity.dot(tangent) * newFriction;\r\n\tjT = jT / (s1.mInvMass + s2.mInvMass + R1crossT * R1crossT * s1.mInertia + R2crossT * R2crossT * s2.mInertia);\r\n\r\n\t//friction should less than force in normal direction\r\n\tif (jT > jN) {\r\n\t\tjT = jN;\r\n\t}\r\n\r\n\t//impulse is from s1 to s2 (in opposite direction of velocity)\r\n\timpulse = tangent.scale(jT);\r\n\r\n\ts1.velocity = s1.velocity.subtract(impulse.scale(s1.mInvMass));\r\n\ts2.velocity = s2.velocity.add(impulse.scale(s2.mInvMass));\r\n\ts1.angularVelocity -= R1crossT * jT * s1.mInertia;\r\n\ts2.angularVelocity += R2crossT * jT * s2.mInertia;\r\n};\r\n\r\n\r\n\r\n","import { Vec2 } from \"./Vec2\";\r\nimport { c, canvas, init } from './canvas';\r\nimport { playerRectCollision, rectCircleCollision } from \"./Engine\";\r\n\r\nvar gravity = 1.5;\r\nvar friction = 0.4;\r\n\r\nexport class Player {\r\n\tconstructor(center, width, height, velocity, color, angle) {\r\n\t\tthis.moving = {\r\n\t\t\tleft: false,\r\n\t\t\tright: false,\r\n\t\t\tup: false\r\n\t\t};\r\n\t\tthis.jumping = false;\r\n\t\tthis.center = center;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.angle = angle;\r\n\t\tthis.velocity = velocity;\r\n\t\tthis.mass = 1;\r\n\t\tthis.color = color;\r\n\t\tthis.vertexes = [\r\n\t\t\tnew Vec2(center.x - height / 2, center.y - height / 2),\r\n\t\t\tnew Vec2(center.x + height / 2, center.y - height / 2),\r\n\t\t\tnew Vec2(center.x + height / 2, center.y + height / 2),\r\n\t\t\tnew Vec2(center.x - height / 2, center.y + height / 2),\r\n\t\t];\r\n\t}\r\n\r\n\tcontroll(key, value) {\r\n\t\tif (key === 'a') {\r\n\t\t\tthis.moving.left = value\r\n\t\t} else if (key === 'd') {\r\n\t\t\tthis.moving.right = value;\r\n\t\t} else if (key === ' ' || key === 'w') {\r\n\t\t\tthis.moving.up = value;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tupdate(rectArray, ballArray) {\r\n\t\tthis.velocity.y += gravity;\r\n\t\tthis.velocity.x *= 0.9;\r\n\r\n\t\t// Check if player died\r\n\t\tif (this.center.y >= canvas.height) {\r\n\t\t\tinit();\r\n\t\t}\r\n\r\n\t\tif (rectArray) {\r\n\t\t\tfor (let rect of rectArray) {\r\n\t\t\t\tif (this.velocity.y >= 0) {\r\n\t\t\t\t\tplayerRectCollision(this, rect);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (ballArray) {\r\n\t\t\tfor (let circle of ballArray) {\r\n\t\t\t\tif (rectCircleCollision(this, circle)) {\r\n\t\t\t\t\tinit();\r\n\t\t\t\t\tconsole.log('collision');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.center.x - (this.width / 2) + this.velocity.x <= 0 || this.center.x + (this.width / 2) + this.velocity.x >= innerWidth) {\r\n\t\t\tthis.velocity.x = - this.velocity.x;\r\n\t\t\tthis.velocity.x = this.velocity.x * friction;\r\n\t\t}\r\n\t\tif (this.moving.left) {\r\n\t\t\tthis.velocity.x -= 1;\r\n\t\t} else if (this.moving.right) {\r\n\t\t\tthis.velocity.x += 1;\r\n\t\t} else if (this.moving.up) {\r\n\t\t\tthis.velocity.y = -20;\r\n\t\t}\r\n\r\n\t\tthis.center.x += this.velocity.x;\r\n\t\tthis.center.y += this.velocity.y;\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tc.beginPath();\r\n\t\tc.rect(this.center.x, this.center.y, this.width, this.height);\r\n\t\tc.fill();\r\n\t\tc.fillStyle = 'red'\r\n\t\tc.strokeStyle = \"red\";\r\n\t\tc.stroke();\r\n\t\tc.closePath();\r\n\t}\r\n}\r\n","import { Vec2 } from \"./Vec2\";\r\nimport { c, canvas } from './canvas';\r\nimport { CollisionInfo } from \"./CollisionInfo\";\r\nimport { resolveCollision } from \"./Engine\";\r\n\r\nvar gravity = 1.5;\r\nvar friction = 0.4;\r\n\r\nexport class Rectangle {\r\n\tconstructor(center, width, height, velocity, color, angle, shouldMove) {\r\n\t\tthis.center = center;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.angle = 0;\r\n\t\tthis.velocity = velocity;\r\n\t\tthis.mass = 1;\r\n\t\tthis.shouldMove = shouldMove;\r\n\t\tthis.mFriction = friction;\r\n\t\tthis.mInvMass = 1;\r\n\t\tthis.angularVelocity = 0;\r\n\t\tthis.angularAcceleration = 0;\r\n\t\tthis.mRestitution = 0.2;\r\n\t\tthis.color = color;\r\n\t\tthis.acceleration = new Vec2(0, 40);\r\n\t\tthis.mInertia = 0;\r\n\t\tthis.mBoundRadius = Math.sqrt(width * width + height * height) / 2;\r\n\t\tthis.vertexes = [\r\n\t\t\tnew Vec2(center.x - width / 2, center.y - height / 2),\r\n\t\t\tnew Vec2(center.x + width / 2, center.y - height / 2),\r\n\t\t\tnew Vec2(center.x + width / 2, center.y + height / 2),\r\n\t\t\tnew Vec2(center.x - width / 2, center.y + height / 2)\r\n\t\t];\r\n\t\tthis.faceNormal = []\r\n\t\tthis.faceNormal[0] = this.vertexes[1].subtract(this.vertexes[2]);\r\n\t\tthis.faceNormal[0] = this.faceNormal[0].normalize();\r\n\t\tthis.faceNormal[1] = this.vertexes[2].subtract(this.vertexes[3]);\r\n\t\tthis.faceNormal[1] = this.faceNormal[1].normalize();\r\n\t\tthis.faceNormal[2] = this.vertexes[3].subtract(this.vertexes[0]);\r\n\t\tthis.faceNormal[2] = this.faceNormal[2].normalize();\r\n\t\tthis.faceNormal[3] = this.vertexes[0].subtract(this.vertexes[1]);\r\n\t\tthis.faceNormal[3] = this.faceNormal[3].normalize();\r\n\t\tthis.kFPS = 20;          // Frames per second\r\n\t\tthis.kFrameTime = 1 / this.kFPS;\r\n\t\tthis.mUpdateIntervalInSeconds = this.kFrameTime;\r\n\t\tthis.rotate(angle)\r\n\t\tthis.updateInertia();\r\n\t}\r\n\r\n\tupdate(rectArray, ballArray) {\r\n\r\n\t\tconst dt = this.mUpdateIntervalInSeconds;\r\n\t\tthis.velocity = this.velocity.add(this.acceleration.scale(dt));\r\n\t\tthis.move(this.velocity.scale(dt));\r\n\t\tthis.angularVelocity += this.angularAcceleration * dt;\r\n\t\tthis.rotate(this.angularVelocity * dt);\r\n\r\n\t\tfor (let i = 0; i < rectArray.length; i++) {\r\n\t\t\tif (this === rectArray[i]) continue;\r\n\t\t\tif (this.boundTest(rectArray[i])) {\r\n\t\t\t\t\tlet collisionInfo = new CollisionInfo();\r\n\t\t\t\t\tif (this.collidedRectRect(this, rectArray[i], collisionInfo)) {\r\n\t\t\t\t\t\tif (collisionInfo.getNormal().dot(rectArray[i].center.subtract(this.center)) < 0) {\r\n\t\t\t\t\t\t\tcollisionInfo.changeDir();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresolveCollision(this, rectArray[i], collisionInfo);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\tmove(v) {\r\n\t\tfor (var i = 0; i < this.vertexes.length; i++) {\r\n\t\t\tthis.vertexes[i] = this.vertexes[i].add(v);\r\n\t\t}\r\n\t\tthis.center = this.center.add(v);\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tc.save();\r\n\t\tc.translate(this.vertexes[0].x, this.vertexes[0].y);\r\n\t\tc.rotate(this.angle);\r\n\t\tc.strokeStyle = this.color;\r\n\t\tc.strokeRect(0, 0, this.width, this.height);\r\n\t\tc.restore();\r\n\t\tc.beginPath();\r\n\t\tc.arc(this.center.x, this.center.y, 5, 0, Math.PI * 2, false);\r\n\t\tc.stroke();\r\n\t\tc.closePath();\r\n\t}\r\n\r\n\t\r\n\trotate(angle) {\r\n\t\tthis.angle += angle;\r\n\r\n\t\tfor (var i = 0; i < this.vertexes.length; i++) {\r\n\t\t\tthis.vertexes[i] = this.vertexes[i].rotate(this.center, angle);\r\n\t\t}\r\n\t\tthis.faceNormal[0] = this.vertexes[1].subtract(this.vertexes[2]);\r\n\t\tthis.faceNormal[0] = this.faceNormal[0].normalize();\r\n\t\tthis.faceNormal[1] = this.vertexes[2].subtract(this.vertexes[3]);\r\n\t\tthis.faceNormal[1] = this.faceNormal[1].normalize();\r\n\t\tthis.faceNormal[2] = this.vertexes[3].subtract(this.vertexes[0]);\r\n\t\tthis.faceNormal[2] = this.faceNormal[2].normalize();\r\n\t\tthis.faceNormal[3] = this.vertexes[0].subtract(this.vertexes[1]);\r\n\t\tthis.faceNormal[3] = this.faceNormal[3].normalize();\r\n\t\treturn this;\r\n\t};\r\n\r\n\tupdateInertia() {\r\n\t\t// Expect this.mInvMass to be already inverted!\r\n\t\tif (this.mInvMass === 0) {\r\n\t\t\tthis.mInertia = 0;\r\n\t\t} else {\r\n\t\t\t//inertia=mass*width^2+height^2\r\n\t\t\tthis.mInertia = (1 / this.mInvMass) * (this.width * this.width + this.height * this.height) / 12;\r\n\t\t\tthis.mInertia = 1 / this.mInertia;\r\n\t\t}\r\n\t};\r\n\r\n\tboundTest(other) {\r\n\t\tvar vFrom1to2 = other.center.subtract(this.center);\r\n\t\tvar rSum = this.mBoundRadius + other.mBoundRadius;\r\n\t\tvar dist = vFrom1to2.length();\r\n\t\tif (dist > rSum) {\r\n\t\t\t//not overlapping\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\r\n\tfindAxisLeastPenetration(otherRect, collisionInfo) {\r\n\r\n\t\tvar n;\r\n\t\tvar supportPoint;\r\n\t\r\n\t\tvar bestDistance = 999999;\r\n\t\tvar bestIndex = null;\r\n\t\r\n\t\tvar hasSupport = true;\r\n\t\tvar i = 0;\r\n\t\t\r\n\t\twhile ((hasSupport) && (i < this.faceNormal.length)) {\r\n\t\t\t// Retrieve a face normal from A\r\n\t\t\tn = this.faceNormal[i];\r\n\t\r\n\t\t\t// use -n as direction and the vectex on edge i as point on edge\r\n\t\t\tvar dir = n.scale(-1);\r\n\t\t\tvar ptOnEdge = this.vertexes[i];\r\n\t\t\t// find the support on B\r\n\t\t\t// the point has longest distance with edge i \r\n\t\t\totherRect.findSupportPoint(dir, ptOnEdge);\r\n\t\t\thasSupport = (tmpSupport.mSupportPoint !== null);\r\n\t\t\t//get the shortest support point depth\r\n\t\t\tif ((hasSupport) && (tmpSupport.mSupportPointDist < bestDistance)) {\r\n\t\t\t\tbestDistance = tmpSupport.mSupportPointDist;\r\n\t\t\t\tbestIndex = i;\r\n\t\t\t\tsupportPoint = tmpSupport.mSupportPoint;\r\n\t\t\t}\r\n\t\t\ti = i + 1;\r\n\t\t}\r\n\t\tif (hasSupport) {\r\n\t\t\t//all four directions have support point\r\n\t\t\tvar bestVec = this.faceNormal[bestIndex].scale(bestDistance);\r\n\t\t\tcollisionInfo.setInfo(bestDistance, this.faceNormal[bestIndex], supportPoint.add(bestVec));\r\n\t\t}\r\n\r\n\t\treturn hasSupport;\r\n\t};\r\n\r\n\tcollidedRectRect(r1, r2, collisionInfo) {\r\n\t\tvar collisionInfoR1 = new CollisionInfo();\r\n\t\tvar collisionInfoR2 = new CollisionInfo();\r\n\t\tvar status1 = false;\r\n\t\tvar status2 = false;\r\n\t\r\n\t\t//find Axis of Separation for both rectangle\r\n\t\tstatus1 = r1.findAxisLeastPenetration(r2, collisionInfoR1);\r\n\t\r\n\t\tif (status1) {\r\n\t\t\tstatus2 = r2.findAxisLeastPenetration(r1, collisionInfoR2);\r\n\t\t\tif (status2) {\r\n\t\t\t\t//if both of rectangles are overlapping, choose the shorter normal as the normal       \r\n\t\t\t\tif (collisionInfoR1.getDepth() < collisionInfoR2.getDepth()) {\r\n\t\t\t\t\tvar depthVec = collisionInfoR1.getNormal().scale(collisionInfoR1.getDepth());\r\n\t\t\t\t\tcollisionInfo.setInfo(collisionInfoR1.getDepth(), collisionInfoR1.getNormal(), collisionInfoR1.mStart.subtract(depthVec));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollisionInfo.setInfo(collisionInfoR2.getDepth(), collisionInfoR2.getNormal().scale(-1), collisionInfoR2.mStart);\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t\t}\r\n\t\treturn status1 && status2;\r\n\t};\r\n}\r\n\r\n\r\n\r\nvar SupportStruct = function () {\r\n    this.mSupportPoint = null;\r\n    this.mSupportPointDist = 0;\r\n};\r\nvar tmpSupport = new SupportStruct();\r\n\r\n\r\nRectangle.prototype.findSupportPoint = function (dir, ptOnEdge) {\r\n    //the longest project length\r\n    var vToEdge;\r\n    var projection;\r\n\r\n    tmpSupport.mSupportPointDist = -9999999;\r\n    tmpSupport.mSupportPoint = null;\r\n    //check each vector of other object\r\n    for (var i = 0; i < this.vertexes.length; i++) {\r\n        vToEdge = this.vertexes[i].subtract(ptOnEdge);\r\n        projection = vToEdge.dot(dir);\r\n        \r\n        //find the longest distance with certain edge\r\n        //dir is -n direction, so the distance should be positive       \r\n        if ((projection > 0) && (projection > tmpSupport.mSupportPointDist)) {\r\n            tmpSupport.mSupportPoint = this.vertexes[i];\r\n            tmpSupport.mSupportPointDist = projection;\r\n        }\r\n\t}\r\n};","import {c, canvas} from './canvas';\r\n\r\nconst gravity = 1.5;\r\nconst bounce = 0.9;\r\nconst friction = 0.9;\r\n\r\nexport class StickBox {\r\n\tconstructor(x, y, width, height) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.points = [];\r\n\t\tthis.sticks = [];\r\n\t\tthis.create();\r\n\t};\r\n\r\n\tupdate() {\r\n\t\tthis.updatePoints();\r\n\t\t\tthis.constrainPoints();\r\n\t\t// for(var i = 0; i < 5; i++) {\r\n\t\t\tthis.updateSticks();\r\n\t\t// }\r\n\t\tthis.renderPoints();\r\n\t\tthis.renderSticks();\r\n\t}\r\n\r\n\tcreate() {\r\n\t\tthis.cratePoint(this.x, this.y);\r\n\t\tthis.cratePoint(this.x + this.width, this.y);\r\n\t\tthis.cratePoint(this.x + this.width, this.y + this.height);\r\n\t\tthis.cratePoint(this.x, this.y + this.height);\r\n\r\n\t\tthis.creatStick(0, 1);\r\n\t\tthis.creatStick(1, 2);\r\n\t\tthis.creatStick(2, 3);\r\n\t\tthis.creatStick(3, 0);\r\n\t\tthis.creatStick(0, 2);\r\n\t\tthis.creatStick(1, 3);\r\n\t}\r\n\r\n\tcreatStick(p1, p2) {\r\n\t\tthis.sticks.push({\r\n\t\t\tp0: this.points[p1],\r\n\t\t\tp1: this.points[p2],\r\n\t\t\tlength: this.distance(this.points[p1], this.points[p2])\r\n\t\t});\r\n\t}\r\n\r\n\tcratePoint(xCor, yCor) {\r\n\t\tthis.points.push({\r\n\t\t\tx: xCor,\r\n\t\t\ty: yCor,\r\n\t\t\toldx: xCor + Math.random() * 30 - 15,\r\n\t\t\toldy: yCor + Math.random() * 30 - 15\r\n\t\t});\r\n\t}\r\n\r\n\tdistance(p0, p1) {\r\n\t\tvar dx = p1.x - p0.x,\r\n\t\t\tdy = p1.y - p0.y;\r\n\t\treturn Math.sqrt(dx * dx + dy * dy);\r\n\t}\r\n\r\n\tupdatePoints() {\r\n\t\tfor(var i = 0; i < this.points.length; i++) {\r\n\t\t\tvar p = this.points[i];\r\n\t\t\tvar vx = (p.x - p.oldx) * friction;\r\n\t\t\tvar vy = (p.y - p.oldy) * friction;\r\n\r\n\t\t\tp.oldx = p.x;\r\n\t\t\tp.oldy = p.y;\r\n\t\t\tp.x += vx;\r\n\t\t\tp.y += vy;\r\n\t\t\tp.y += gravity;\r\n\t\t}\r\n\t}\r\n\r\n\tconstrainPoints() {\r\n\t\tfor(var i = 0; i < this.points.length; i++) {\r\n\t\t\tvar p = this.points[i],\r\n\t\t\t\tvx = (p.x - p.oldx) * friction,\r\n\t\t\t\tvy = (p.y - p.oldy) * friction;\r\n\r\n\t\t\tif(p.x > canvas.width) {\r\n\t\t\t\tp.x = canvas.width;\r\n\t\t\t\tp.oldx = p.x + vx * bounce;\r\n\t\t\t}\r\n\t\t\telse if(p.x < 0) {\r\n\t\t\t\tp.x = 0;\r\n\t\t\t\tp.oldx = p.x + vx * bounce;\r\n\t\t\t}\r\n\t\t\tif(p.y > canvas.height) {\r\n\t\t\t\tp.y = canvas.height;\r\n\t\t\t\tp.oldy = p.y + vy * bounce;\r\n\t\t\t}\r\n\t\t\telse if(p.y < 0) {\r\n\t\t\t\tp.y = 0;\r\n\t\t\t\tp.oldy = p.y + vy * bounce;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tupdateSticks() {\r\n\t\tfor(var i = 0; i < this.sticks.length; i++) {\r\n\t\t\tvar s = this.sticks[i],\r\n\t\t\t\tdx = s.p1.x - s.p0.x,\r\n\t\t\t\tdy = s.p1.y - s.p0.y,\r\n\t\t\t\tdistance = Math.sqrt(dx * dx + dy * dy),\r\n\t\t\t\tdifference = s.length - distance,\r\n\t\t\t\tpercent = difference / distance / 2,\r\n\t\t\t\toffsetX = dx * percent,\r\n\t\t\t\toffsetY = dy * percent;\r\n\r\n\t\t\ts.p0.x -= offsetX;\r\n\t\t\ts.p0.y -= offsetY;\r\n\t\t\ts.p1.x += offsetX;\r\n\t\t\ts.p1.y += offsetY;\r\n\t\t}\r\n\t}\r\n\r\n\trenderPoints() {\r\n\t\t// for(var i = 0; i < this.points.length; i++) {\r\n\t\t// \tvar p = this.points[i];\r\n\t\t// \tc.beginPath();\r\n\t\t// \tc.arc(p.x, p.y, 5, 0, Math.PI * 2);\r\n\t\t// \tc.fill();\r\n\t\t// \tc.fillStyle = 'red'\r\n\t\t// \tc.closePath()\r\n\t\t// }\r\n\t}\r\n\r\n\trenderSticks() {\r\n\t\tc.beginPath();\r\n\t\tfor(var i = 0; i < this.sticks.length; i++) {\r\n\t\t\tvar s = this.sticks[i];\r\n\t\t\tc.moveTo(s.p0.x, s.p0.y);\r\n\t\t\tc.lineTo(s.p1.x, s.p1.y);\r\n\t\t\tc.strokeStyle = 'red'\r\n\t\t}\r\n\t\tc.stroke();\r\n\t\tc.closePath();\r\n\t}\r\n}","\r\nexport class Vec2 {\r\n\tconstructor(x, y) {\r\n\t\tthis.x = x; \r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\tlength() {\r\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\r\n\t};\r\n\t\r\n\tadd(vec) {\r\n\t\treturn new Vec2(vec.x + this.x, vec.y + this.y);\r\n\t};\r\n\r\n\tsubtract(vec) {\r\n\t\treturn new Vec2(this.x - vec.x, this.y - vec.y);\r\n\t};\r\n\t\r\n\tscale(n) {\r\n\t\treturn new Vec2(this.x * n, this.y * n);\r\n\t};\r\n\t\r\n\tdot(vec) {\r\n\t\treturn (this.x * vec.x + this.y * vec.y);\r\n\t};\r\n\t\r\n\tcross(vec) {\r\n\t\treturn (this.x * vec.y - this.y * vec.x);\r\n\t};\r\n\t\r\n\tnormalize() {\r\n\t\tvar len = this.length();\r\n\t\tif (len > 0) {\r\n\t\t\tlen = 1 / len;\r\n\t\t}\r\n\t\treturn new Vec2(this.x * len, this.y * len);\r\n\t};\r\n\t\r\n\trotate(center, angle) {\r\n\t\t//rotate in counterclockwise\r\n\t\tvar r = [];\r\n\t\r\n\t\tvar x = this.x - center.x;\r\n\t\tvar y = this.y - center.y;\r\n\t\r\n\t\tr[0] = x * Math.cos(angle) - y * Math.sin(angle);\r\n\t\tr[1] = x * Math.sin(angle) + y * Math.cos(angle);\r\n\t\r\n\t\tr[0] += center.x;\r\n\t\tr[1] += center.y;\r\n\t\r\n\t\treturn new Vec2(r[0], r[1]);\r\n\t};\r\n\r\n\tdistance(vec) {\r\n\t\tvar x = this.x - vec.x;\r\n\t\tvar y = this.y - vec.y;\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t};\r\n\t\r\n}","import utils from './utils';\r\nimport {Ball} from './Ball';\r\nimport { Rectangle } from './Rectangle';\r\nimport { Vec2 } from './Vec2';\r\nimport { Player } from './Player';\r\nimport { StickBox } from './StickBox';\r\n\r\nexport const canvas = document.querySelector('canvas');\r\nexport const c = canvas.getContext('2d');\r\n\r\ncanvas.width = innerWidth\r\ncanvas.height = innerHeight\r\n\r\nlet charInput = false;\r\nlet moving = false;\r\nlet line = [];\r\nconst mouse = {\r\n  x: innerWidth / 2,\r\n  y: innerHeight / 2\r\n}\r\n\r\n/** PlaceHolder line for shooting directions */\r\nclass Line {\r\n  constructor(x, y, toX, toY) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.toX = toX;\r\n    this.toY = toY;\r\n  }\r\n\r\n  update() {\r\n    this.draw();\r\n  }\r\n\r\n  draw() {\r\n    c.beginPath();\r\n    c.moveTo(this.x, this.y);\r\n    c.lineTo(mouse.x, mouse.y);\r\n    c.stroke();\r\n    c.strokeStyle = 'black';\r\n  }\r\n}\r\n\r\nconst colors = ['#2185C5', '#7ECEFD', '#FFF6E5', '#FF7F66']\r\n\r\n// Event Listeners\r\n// addEventListener('mousemove', (event) => {\r\n//   if (moving) {\r\n//     placeH.center.y = event.clientY;\r\n//     placeH.center.x = event.clientX; \r\n//   }\r\n// });\r\n\r\naddEventListener('keydown', (event) => {\r\n  player.controll(event.key, true);\r\n});\r\n\r\naddEventListener('keyup', (event) => {\r\n  player.controll(event.key, false);\r\n});\r\n\r\n\r\n\r\naddEventListener('resize', () => {\r\n  canvas.width = innerWidth\r\n  canvas.height = innerHeight\r\n  init()\r\n});\r\n\r\nlet placeH = null;\r\nlet extra = {\r\n  x: null,\r\n  y: null,\r\n  width: null,\r\n  height: null,\r\n}\r\n\r\naddEventListener('mousedown', (event) => {\r\n  mouse.x = event.clientX;\r\n  mouse.y = event.clientY;\r\n  placeH = new Rectangle(new Vec2(mouse.x, mouse.y), 100, 20, new Vec2(0,0), 'purple', 0, false);\r\n  moving = true;\r\n})\r\n\r\naddEventListener('mouseup', (event) => {\r\n  moving = false;\r\n  rectArray.push(placeH);\r\n  placeH = null;\r\n})\r\n\r\n\r\n\r\n\r\n// Implementation\r\nvar ballArray = [];\r\nvar rectArray = [];\r\nlet player = null;\r\nlet stickyBox = null;\r\n\r\nexport function init() {\r\n  ballArray = [];\r\n  stickyBox = new StickBox(100, 100, 100, 100);\r\n  player = new Player(new Vec2(canvas.width / 2, canvas.height / 2), 20, 20, new Vec2(0, 0), 'blue', 0);\r\n  [0,1,2,3,4,5,6,6,7,8,3].map(() => {\r\n    rectArray.push(new Rectangle(new Vec2(utils.randomIntFromRange(0, canvas.width), utils.randomIntFromRange(0, canvas.height)), 100, 20, new Vec2(utils.randomIntFromRange(-40, 40), utils.randomIntFromRange(-40, 40)), 'green', utils.randomIntFromRange(0, 4), true));\r\n  })\r\n  rectArray.push(new Rectangle(new Vec2(canvas.width / 2, canvas.height / 2), 200, 30, new Vec2(0, 0), 'green', 0, false));\r\n\r\n  // rectArray.push(new Rectangle(new Vec2(canvas.width / 2 - 100, canvas.height / 2), 100, 20, new Vec2(20, 0), 'green', utils.randomIntFromRange(0, 4)));\r\n  // rectArray.push(new Rectangle(new Vec2(canvas.width / 2 + 100, canvas.height / 2), 100, 20, new Vec2(-20, 0), 'green', utils.randomIntFromRange(0, 4)));\r\n\r\n\tfor (let i = 0; i < 7; i++) {\r\n\t\tvar radius = 30;\r\n\t\tvar x = utils.randomIntFromRange(radius, canvas.width - radius)\r\n\t\tvar y = utils.randomIntFromRange(radius, canvas.height - radius)\r\n\t\tvar dx = utils.randomIntFromRange(-3, 3)\r\n\t\tvar dy = utils.randomIntFromRange(-2, 2)\r\n    \r\n    if ( i !== 0) {\r\n      for (let j = 0; j < ballArray.length; j++) {\r\n          const prev = ballArray[j];\r\n          if((distance(x, y, prev.x, prev.y) - (radius * 2))  < 0) {\r\n            var x = utils.randomIntFromRange(radius, canvas.width - radius);\r\n            var y = utils.randomIntFromRange(radius, canvas.height - radius);\r\n            \r\n            j = -1;\r\n          }\r\n      }\r\n    } \r\n\r\n    ballArray.push(new Ball(x, y, dx, dy, radius, 'blue', false));\r\n\t}\r\n}\r\n\r\nexport function distance(x1, y1, x2, y2) {\r\n  const xDist = x2 - x1;\r\n  const yDist = y2 - y1;\r\n  return Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));\r\n}\r\n\r\n// Animation Loop\r\nfunction animate() {\r\n  requestAnimationFrame(animate)\r\n  c.clearRect(0, 0, canvas.width, canvas.height)\r\n  \r\n  ballArray.forEach(ball => {\r\n   ball.update(ballArray, rectArray);\r\n  });\r\n\r\n  if (line) {\r\n    line.forEach(li => {\r\n      li.update();\r\n    })\r\n  }\r\n  rectArray.forEach((rect) => {\r\n    rect.update(rectArray, ballArray);\r\n  })\r\n  \r\n  // player.update(rectArray, ballArray);\r\n  // stickyBox.update();\r\n\r\n  // if (placeH) {\r\n  //   placeH.update();\r\n  // }\r\n}\r\n\r\n\r\ninit()\r\nanimate()\r\n","function randomIntFromRange(min, max) {\n  return Math.floor(Math.random() * (max - min + 1) + min)\n}\n\nfunction randomColor(colors) {\n  return colors[Math.floor(Math.random() * colors.length)]\n}\n\nfunction distance(x1, y1, x2, y2) {\n  const xDist = x2 - x1\n  const yDist = y2 - y1\n\n  return Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2))\n}\n\nmodule.exports = { randomIntFromRange, randomColor, distance }\n"],"sourceRoot":""}